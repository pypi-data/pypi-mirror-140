"use strict";(self.webpackChunkxircuits=self.webpackChunkxircuits||[]).push([[807],{92807:(e,t,n)=>{n.r(t),n.d(t,{IXircuitsDocTracker:()=>Be,default:()=>Re});var o=n(56271),i=n.n(o),a=n(3770),r=n(56541),s=n(89138),l=n(28800),c=n.n(l);const d=c().div`
		height: 100%;
		background-color: ${e=>e.background};
		background-size: 50px 50px;
		display: flex;

		> * {
			height: 100%;
			min-height: 100%;
			width: 100%;
		}
		background-image: linear-gradient(
				0deg,
				transparent 24%,
				${e=>e.color} 25%,
				${e=>e.color} 26%,
				transparent 27%,
				transparent 74%,
				${e=>e.color} 75%,
				${e=>e.color} 76%,
				transparent 77%,
				transparent
			),
			linear-gradient(
				90deg,
				transparent 24%,
				${e=>e.color} 25%,
				${e=>e.color} 26%,
				transparent 27%,
				transparent 74%,
				${e=>e.color} 75%,
				${e=>e.color} 76%,
				transparent 77%,
				transparent
			);
	`;class u extends o.Component{render(){return o.createElement(d,{background:this.props.background||"rgb(60, 60, 60)",color:this.props.color||"rgba(255,255,255, 0.05)"},this.props.children)}}var g=n(68675),p=n.n(g),m=n(96148);class h extends g.DefaultPortModel{constructor(){super(...arguments),this.canParameterLinkToPort=(e,t)=>{let n=this.getNode().getOptions().extras.type,o=t.getName();if(1==this.isParameterNode(n)){if(console.log("port name: ",o),console.log("parameter port: ",t.getNode().getInPorts()),Object.keys(t.getLinks()).length>0)return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port has other link",t.getNode().setSelected(!0),!1;if(!o.startsWith("parameter"))return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port linked is not parameter, please link a non parameter node to it",t.getNode().setSelected(!0),!1;for(let e=0;e<t.getNode().getInPorts().length;e++){let n=t.getNode().getInPorts()[e].getOptions().id;if(t.getID()==n)var i=e}let e=/\-([^-]+)\-/,a=t.getNode().getInPorts()[i].getOptions().name.match(e);if(n!=a[1])return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port linked not correct data type ("+a[1]+")",t.getNode().setSelected(!0),!1}else{if(o.startsWith("parameter")){if(o.includes("any"))return;return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Node link to this port must be a hyperparameter/literal",t.getNode().setSelected(!0),!1}if(Object.keys(t.getLinks()).length>0)return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port has link, please delete the current link to proceed",t.getNode().setSelected(!0),!1}return t.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete t.getNode().getOptions().extras.tip,e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,!0},this.isParameterNode=e=>"boolean"===e||"int"===e||"float"===e||"string"===e||"list"===e||"tuple"===e||"dict"===e,this.canTriangleLinkToTriangle=(e,t)=>{let n=t.getOptions().label,o=this.options.label,i=this.getNode(),a=(t.getNode(),i.getOptions().extras.type);return this.isParameterNode(a)?(t.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete t.getNode().getOptions().extras.tip,e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,!0):o.endsWith("▶")||"▶"==n?"▶"===n&&o.endsWith("▶")&&!(Object.keys(e.getLinks()).length>1):(t.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete t.getNode().getOptions().extras.tip,e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,!0)},this.getCircularReplacer=()=>{var e=[];return(t,n)=>{if("object"==typeof n&&null!==n){if(e.indexOf(n)>=0)return;e.push(n)}return n}},this.checkLinkDirection=(e,t)=>"right"===e.getOptions().alignment&&"left"===t.getOptions().alignment,this.checkExecutionLoop=(e,t)=>{let n=[],o=e.getParent(),i=t.getParent(),a=o.getOptions().extras.type;for(n.push(o.getID(),i.getID());null!=o&&"Start"!=a&&"boolean"!=a&&"int"!=a&&"float"!=a&&"string"!=a&&"list"!=a&&"tuple"!=a&&"dict"!=a;){let e=o.getInPorts();for(let t=0;t<=e.length;t++)if("▶"===e[t].getOptions().label){let i=e[t].getLinks();if(1!==Object.keys(i).length){Object.keys(i).length>1&&console.log("zombie link detected"),o=null;break}if(o=i[Object.keys(i).toString()].getSourcePort().getParent(),a=o.getOptions().extras.type,n.includes(o.getID()))return console.log("Loop detected at",o.getOptions().name),!1;n.push(o.getID());break}}for(;null!=i&&"Finish"!=i.getOptions().name;){let e=i.getOutPorts();for(let t=0;t<=e.length;t++)if("▶"===e[t].getOptions().label){let o=e[t].getLinks();if(1!==Object.keys(o).length){Object.keys(o).length>1&&console.log("zombie link detected"),i=null;break}if(i=o[Object.keys(o).toString()].getTargetPort().getParent(),n.includes(i.getID()))return console.log("Loop detected at",i.getOptions().name),!1;n.push(i.getID());break}}return!0}}canLinkToPort(e){return e instanceof g.DefaultPortModel&&this.options.in===e.getOptions().in?(e.getNode().getOptions().extras.borderColor="red",e.getNode().getOptions().extras.tip="in not connected to in",e.getNode().setSelected(!0),console.log("in not connected to in"),!1):0==this.canParameterLinkToPort(this,e)?(console.log("Parameter Link To Port failed."),!1):0==this.canTriangleLinkToTriangle(this,e)?(e.getNode().getOptions().extras.borderColor="red",e.getNode().getOptions().extras.tip="Triangle must be linked to triangle",e.getNode().setSelected(!0),console.log("triangle to triangle failed."),!1):0==this.checkLinkDirection(this,e)?(e.getNode().getOptions().extras.borderColor="red",e.getNode().getOptions().extras.tip="Port should be created from outPort [right] to inPort [left]",e.getNode().setSelected(!0),console.log("Port should be created from outPort [right] to inPort [left]"),!1):0!=this.checkExecutionLoop(this,e)&&(e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,this.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete this.getNode().getOptions().extras.tip,!0)}}class b extends g.DefaultNodeModel{constructor(e={}){super(Object.assign(Object.assign({},e),{type:"custom-node"})),this.color=e.color||"red",this.name=e.name||"",this.extras=e.extras||{}}serialize(){return Object.assign(Object.assign({},super.serialize()),{color:this.color,name:this.name,extras:this.extras})}deserialize(e){super.deserialize(e),this.color=e.data.color,this.name=e.data.name,this.extras=e.data.extras}addOutPortEnhance(e,t,n=!0,o){const i=new h(o?{in:!1,name:t,label:e,id:o}:{in:!1,name:t,label:e});return n||this.portsOut.splice(0,0,i),this.addPort(i)}addInPortEnhance(e,t,n=!0,o){const i=new h(o?{in:!0,name:t,label:e,id:o}:{in:!0,name:t,label:e});return n||this.portsOut.splice(0,0,i),this.addPort(i)}}var x=n(89381),f=n(41797);class v extends m.ReactWidget{constructor(e){super(),this.handleChange=e=>{this._logConsole.logger&&(this._logConsole.logger.level=e.target.value),this.update()},this.handleKeyDown=e=>{13===e.keyCode&&this._logConsole.activate()},this._id=`level-${f.UUID.uuid4()}`,this.addClass("jp-LogConsole-toolbarLogLevel"),this._logConsole=e,this._logConsole.logger.level="debug",e.source&&this.update(),e.sourceChanged.connect(this._updateSource,this)}_updateSource(e,{oldValue:t,newValue:n}){null!==t&&e.loggerRegistry.getLogger(t).stateChanged.disconnect(this.update,this),null!==n&&e.loggerRegistry.getLogger(n).stateChanged.connect(this.update,this),this.update()}render(){const e=this._logConsole.logger;return i().createElement(i().Fragment,null,i().createElement("label",{htmlFor:this._id,className:null===e?"jp-LogConsole-toolbarLogLevel-disabled":void 0},"Log Level:"),i().createElement(x.HTMLSelect,{id:this._id,className:"jp-LogConsole-toolbarLogLevelDropdown",onChange:this.handleChange,onKeyDown:this.handleKeyDown,value:null==e?void 0:e.level,"aria-label":"Log level",disabled:null===e,options:null===e?[]:["Critical","Error","Warning","Info","Debug"].map((e=>({label:e,value:e.toLowerCase()})))}))}}var S,w=n(13205),y=n(76032);!function(e){e.addCheckpoint="Xircuit-log:add-checkpoint",e.clear="Xircuit-log:clear",e.openLog="Xircuit-log:open",e.setLevel="Xircuit-log:set-level"}(S||(S={}));const E={id:"xircuit-log",autoStart:!0,requires:[m.ICommandPalette,a.ILayoutRestorer,w.IRenderMimeRegistry],activate:(e,t,n,o)=>{console.log("Xircuit-Log is activated!");let i=null,a=null;const r=new m.WidgetTracker({namespace:"Xircuit-log"});n&&n.restore(r,{command:S.openLog,name:()=>"Xircuit-log"}),e.commands.addCommand(S.addCheckpoint,{execute:()=>{var e;return null===(e=null==i?void 0:i.logger)||void 0===e?void 0:e.checkpoint()},icon:x.addIcon,isEnabled:()=>!!i&&null!==i.source,label:"Add Checkpoint"}),e.commands.addCommand(S.clear,{execute:()=>{var e;return null===(e=null==i?void 0:i.logger)||void 0===e?void 0:e.clear()},icon:x.clearIcon,isEnabled:()=>!!i&&null!==i.source,label:"Clear Log"}),e.commands.addCommand(S.setLevel,{execute:e=>{(null==i?void 0:i.logger)&&(i.logger.level=e.level)},isEnabled:()=>!!i&&null!==i.source,label:e=>`Set Log Level to ${e.level}`}),e.commands.addCommand(S.openLog,{label:"Open Xircuits Log Console",caption:"Xircuits log console",icon:x.listIcon,isToggled:()=>null!==a,execute:()=>{a?a.dispose():(i=new y.LogConsolePanel(new y.LoggerRegistry({defaultRendermime:o,maxLength:1e3})),i.source="xircuit",a=new m.MainAreaWidget({content:i}),a.addClass("jp-LogConsole"),a.title.label="xircuits Log console",a.title.icon=x.listIcon,a.toolbar.addItem("checkpoint",new m.CommandToolbarButton({commands:e.commands,id:S.addCheckpoint})),a.toolbar.addItem("clear",new m.CommandToolbarButton({commands:e.commands,id:S.clear})),a.toolbar.addItem("level",new v(a.content)),a.disposed.connect((()=>{a=null,i=null,e.commands.notifyCommandChanged()})),e.shell.add(a,"main",{mode:"split-bottom"}),r.add(a),a.update(),e.commands.notifyCommandChanged())}}),t.addItem({command:S.openLog,category:"Examples"}),e.commands.addCommand("jlab-examples/custom-log-console:logHTMLMessage",{label:"HTML log message",caption:"Custom HTML log message example.",execute:()=>{var e;null===(e=null==i?void 0:i.logger)||void 0===e||e.log({type:"html",level:"debug",data:"<div>Hello world HTML!!</div>"})}}),e.commands.addCommand("jlab-examples/custom-log-console:logTextMessage",{label:"Text log message",caption:"Custom text log message example.",execute:()=>{var e;null===(e=null==i?void 0:i.logger)||void 0===e||e.log({type:"text",level:"info",data:"Hello world text!!"})}}),e.commands.addCommand($.outputMsg,{label:"Output log message",caption:"Output xircuits log message.",execute:e=>{var t;const n=void 0===e.outputMsg?"":e.outputMsg,o={type:"output",level:e.level,data:{output_type:"display_data",data:{"text/plain":n}}};null===(t=null==i?void 0:i.logger)||void 0===t||t.log(o)}})}};class k{constructor(e){this.app=e}debug(e,...t){this.emitLogMessage("debug",e,t)}info(e,...t){this.emitLogMessage("info",e,t)}warn(e,...t){this.emitLogMessage("warning",e,t)}error(e,...t){this.emitLogMessage("error",e,t)}critical(e,...t){this.emitLogMessage("critical",e,t)}emitLogMessage(e,t,n){if(n.length>0){const o=t+n;this.app.commands.execute($.outputMsg,{outputMsg:o,level:e})}else this.app.commands.execute($.outputMsg,{outputMsg:t,level:e})}}var O=n(16077),C=n(14982);async function _(e="",t={}){const n=C.ServerConnection.makeSettings(),o=O.URLExt.join(n.baseUrl,"xircuits",e);let i;try{i=await C.ServerConnection.makeRequest(o,t,n)}catch(e){throw new C.ServerConnection.NetworkError(e)}const a=await i.json();if(!i.ok)throw new C.ServerConnection.ResponseError(i,a.message);return a}async function N(e){return await async function(){return await _("components/")}()}var D=n(13211),P=n(23706);const M=e=>{const t=m.ReactWidget.create(e);return D.MessageLoop.sendMessage(t,P.Widget.Msg.UpdateRequest),t.getValue=()=>{var e;const n=t.node.querySelector("form"),o={};for(const t of Object.values(null!==(e=null==n?void 0:n.elements)&&void 0!==e?e:[]))"checkbox"===t.type?o[t.name]=t.checked:o[t.name]=t.value;return o},t},I=(e,t)=>{e.value.trim()?t.add(e):t.delete(e)},L=(e,t,n)=>{e.size===t.length?(e=>{e.removeAttribute("disabled")})(n):(e=>{e.setAttribute("disabled","disabled")})(n)};var X=n(96637),T=n(76442),A=n.n(T),W=n(69519),z=n.n(W);const F=({childSparkSubmitNodes:e,childStringNodes:t,childBoolNodes:n,childIntNodes:a,childFloatNodes:r})=>{const[s,l]=(0,o.useState)([!1]);return i().createElement("form",null,i().createElement("h3",{style:{marginTop:0,marginBottom:5}},"Hyperparameter:"),i().createElement("div",null,0!=e.length?i().createElement(i().Fragment,null,i().createElement("div",null,i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Spark Submit")),i().createElement("div",null,e,i().createElement("div",null,i().createElement(A(),{minRows:3,maxRows:8,name:e,style:{width:205,fontSize:12},autoFocus:!0})))):null),i().createElement("div",null),i().createElement("div",null,i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"String")),t.map(((e,t)=>i().createElement("div",{key:`index-${t}`},e,i().createElement("div",null,i().createElement("input",{type:"text",name:e}))))),i().createElement("div",null,0!=n.length?i().createElement(i().Fragment,null,i().createElement("br",null),i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Boolean")):null),n.map(((e,t)=>i().createElement("div",{key:`index-${t}`},e,i().createElement("div",null,i().createElement(z(),{checked:s[t]||!1,name:e,onChange:e=>((e,t)=>{let n=[...s];n[t]=e,l(n),console.log("Boolean change: ",s)})(e,t),handleDiameter:25,height:20,width:48}))))),i().createElement("div",null,0!=a.length?i().createElement(i().Fragment,null,i().createElement("br",null),i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Integer")):null),a.map(((e,t)=>i().createElement("div",{key:`index-${t}`},e,i().createElement("div",null,i().createElement(X,{className:"form-control",name:e,value:"0",min:0,step:1,precision:0,mobile:!0,style:{wrap:{boxShadow:"0 0 1px 1px #fff inset, 1px 1px 5px -1px #000",padding:"2px 2.26ex 2px 2px",borderRadius:"6px 3px 3px 6px",fontSize:20,width:"10vw"},input:{borderRadius:"6px 3px 3px 6px",padding:"0.1ex 1ex",border:"#ccc",marginRight:4,display:"block",fontWeight:100,width:"11.3vw"},plus:{background:"rgba(255, 255, 255, 100)"},minus:{background:"rgba(255, 255, 255, 100)"},btnDown:{background:"rgba(0, 0, 0)"},btnUp:{background:"rgba(0, 0, 0)"}}}))))),i().createElement("div",null,0!=r.length?i().createElement(i().Fragment,null,i().createElement("br",null),i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Float")):null),r.map(((e,t)=>i().createElement("div",{className:"p-col-12",key:`index-${t}`},e,i().createElement("div",null,i().createElement(X,{className:"form-control",name:e,value:"0.00",min:0,step:.1,precision:2,mobile:!0,style:{wrap:{boxShadow:"0 0 1px 1px #fff inset, 1px 1px 5px -1px #000",padding:"2px 2.26ex 2px 2px",borderRadius:"6px 3px 3px 6px",fontSize:20,width:"10vw"},input:{borderRadius:"6px 3px 3px 6px",padding:"0.1ex 1ex",border:"#ccc",marginRight:4,display:"block",fontWeight:100,width:"11.3vw"},plus:{background:"rgba(255, 255, 255, 100)"},minus:{background:"rgba(255, 255, 255, 100)"},btnDown:{background:"rgba(0, 0, 0)"},btnUp:{background:"rgba(0, 0, 0)"}}}))))))};n(25872);const B=c().div`
		flex-grow: 1;
		display: flex;
		flex-direction: column;
		min-height: 100%;
		height: 800px;
	`,R=(c().div`
		display: flex;
		background: rgb(30, 30, 30);
		flex-grow: 0;
		flex-shrink: 0;
		color: white;
		font-family: Helvetica, Arial, sans-serif;
		padding: 10px;
		align-items: center;
	`,c().div`
		display: flex;
		flex-grow: 1;
	`),j=c().div`
		position: relative;
		flex-grow: 1;
	`,$={openXircuitEditor:"Xircuit-editor:open",openDocManager:"docmanager:open",newDocManager:"docmanager:new-untitled",saveDocManager:"docmanager:save",reloadDocManager:"docmanager:reload",revertDocManager:"docmanager:restore-checkpoint",createNewXircuit:"Xircuit-editor:create-new",saveXircuit:"Xircuit-editor:save-node",compileXircuit:"Xircuit-editor:compile-node",runXircuit:"Xircuit-editor:run-node",debugXircuit:"Xircuit-editor:debug-node",lockXircuit:"Xircuit-editor:lock-node",undo:"Xircuit-editor:undo",redo:"Xircuit-editor:redo",cutNode:"Xircuit-editor:cut-node",copyNode:"Xircuit-editor:copy-node",pasteNode:"Xircuit-editor:paste-node",editNode:"Xircuit-editor:edit-node",deleteNode:"Xircuit-editor:delete-node",createArbitraryFile:"Xircuit-editor:create-arbitrary-file",openDebugger:"Xircuit-debugger:open",breakpointXircuit:"Xircuit-editor:breakpoint-node",nextNode:"Xircuit-editor:next-node",testXircuit:"Xircuit-editor:test-node",outputMsg:"Xircuit-log:logOutputMessage",executeToOutputPanel:"Xircuit-output-panel:execute"},H=({context:e,xircuitsApp:t,app:n,shell:a,commands:r,widgetId:l,serviceManager:c,saveXircuitSignal:d,compileXircuitSignal:p,runXircuitSignal:h,runTypeXircuitSignal:x,debugXircuitSignal:f,lockNodeSignal:v,breakpointXircuitSignal:S,currentNodeSignal:w,testXircuitSignal:y,continueDebugSignal:E,nextNodeDebugSignal:O,stepOverDebugSignal:C,terminateDebugSignal:D,stepInDebugSignal:X,stepOutDebugSignal:T,evaluateDebugSignal:A,debugModeSignal:W})=>{const[z,H]=(0,o.useState)(0),U=(0,o.useCallback)((()=>H((e=>e+1))),[]),[V,J]=(0,o.useState)(!1),[G,K]=(0,o.useState)(!1),[q,Q]=(0,o.useState)(!0),[Y,Z]=(0,o.useState)([]),[ee,te]=(0,o.useState)(!1),[ne,oe]=(0,o.useState)(!1),[ie,ae]=(0,o.useState)(!1),[re,se]=(0,o.useState)(""),[le,ce]=(0,o.useState)(["experiment name"]),[de,ue]=(0,o.useState)([]),[ge,pe]=(0,o.useState)([]),[me,he]=(0,o.useState)([]),[be,xe]=(0,o.useState)([""]),[fe,ve]=(0,o.useState)([0]),[Se,we]=(0,o.useState)([0]),[ye,Ee]=(0,o.useState)([!1]),[ke,Oe]=(0,o.useState)([]),[Ce,_e]=(0,o.useState)(!1),[Ne,De]=(0,o.useState)(!1),[Pe,Me]=(0,o.useState)(!1),[Ie,Le]=(0,o.useState)(!1),[Xe,Te]=(0,o.useState)(!1),[Ae,We]=(0,o.useState)(-1),[ze,Fe]=(0,o.useState)("run"),Be=new k(n),Re=(0,o.useRef)(e),je=(0,o.useRef)(!1),$e=(0,o.useCallback)((()=>{if(Re.current.isReady){let e=t.getDiagramEngine().getModel().serialize();Re.current.model.fromString(JSON.stringify(e,null,4)),J(!1)}}),[]);(0,o.useEffect)((()=>{const e=Re.current,n=()=>{const n=e.model.toString();if(He(n))try{if(je.current){let n=((e,t)=>{if(null==e)return;let n=new g.DiagramModel,o=e.layers[0].models,i=e.layers[1].models,a=e.offsetX,r=e.offsetY,s=e.zoom;for(let e in i){let o=i[e],a=new b({id:o.id,type:o.type,name:o.name,locked:o.locked,color:o.color,extras:o.extras});a.setPosition(o.x,o.y);for(let e in o.ports){let t=o.ports[e];"right"==t.alignment&&a.addOutPortEnhance(t.label,t.name,!0,t.id),"left"==t.alignment&&a.addInPortEnhance(t.label,t.name,!0,t.id)}n.addAll(a),t.setModel(n)}for(let e in o){let i=o[e];if(i.sourcePort&&i.targetPort){let e=new g.DefaultLinkModel,o=n.getNode(i.source).getPortFromID(i.sourcePort);e.setSourcePort(o);let a=n.getNode(i.target).getPortFromID(i.targetPort);e.setTargetPort(a),n.addAll(e),t.setModel(n)}}return n.registerListener({nodesUpdated:()=>{const e=setTimeout((()=>{$e(),Q(!1)}),10);return()=>clearTimeout(e)},linksUpdated:function(e){e.link.registerListener({sourcePortChanged:e=>{$e()},targetPortChanged:e=>{$e()},entityRemoved:e=>{$e()}})}}),n.setOffsetX(a),n.setOffsetY(r),n.setZoomLevel(s),n})(e.model.toJSON(),t.getDiagramEngine());t.getDiagramEngine().setModel(n)}else je.current=!0,e.model.sharedModel.clearUndoHistory()}catch(e){(0,m.showErrorMessage)("Error",i().createElement("pre",null,e))}};return e.ready.then(n),e.model.contentChanged.connect(n),()=>{e.model.contentChanged.disconnect(n)}}),[]);const He=e=>{try{return JSON.parse(e)&&!!e}catch(e){return!1}},Ue=(e,t)=>{for(let n=0;n<e.length;n++)if(e[n].getID()===t)return n;return null},Ve=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n];if(o.getSourcePort().getNode().getID()===t&&"▶"==o.getTargetPort().getOptions().label)return o.getTargetPort().getNode().getID()}return null},Je=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n];if(o.getOptions().name===t)return o}return null},Ge=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n];if(o.getID()===t)return o}return null},Ke=()=>{let e=t.getDiagramEngine().getModel(),n=e.getNodes(),o=Je(n,"Start");if(null==o&&(o=Je(n,"🔴Start")),o){let t=o.getID(),i=[];for(i.push(o);null!=Ve(e.getLinks(),t);){let o=Ve(e.getLinks(),t);if(o){let e=Ge(n,o);e&&(t=e.getID(),i.push(e))}}return i}return null},qe=()=>{let e=new Map(ke.map((e=>[e.task,e]))),n=ke.map((e=>e.task)),o=t.getDiagramEngine().getModel(),i=o.getNodes(),a=Je(i,"Start"),r="from argparse import ArgumentParser\n";r+="from datetime import datetime\n",r+="from time import sleep\n",r+="import json, os, signal\n",r+="from flask import Flask, jsonify, request\n",r+="from threading import Thread\n";let s={},l=Ke();for(let e in l){let t=l[e].extras.type,n=l[e].name;n=n.replace(/\s+/g,""),"Start"==t||"Finish"==t||"boolean"===t||"int"===t||"float"===t||"string"===t||(s[n]=n)}let c=new Set;for(let t in s){let n=e.get(t)||{python_path:null};null!=n.python_path&&c.add(n.python_path)}c.size>0&&(r+="import sys\n"),c.forEach((e=>{r+=`sys.path.append("${e.replace(/\\/gi,"\\\\")}")\n`}));for(let e in s){let t,o=n.indexOf(e),i="components";-1!=o&&(t=ke[o],i=t.package_name),r+="from "+i+" import "+e+"\n"}r+="\napp = Flask(__name__)\n",r+="input_data = []\n",r+="continue_input_data = []\n",r+="inarg_output_data = []\n",r+="outarg_output_data = []\n",r+="is_done_list = []\n",r+="\ndef main(args):\n\n",r+="    ctx = {}\n",r+="    ctx['args'] = args\n\n";for(let e=0;e<l.length;e++){let t=l[e].extras.type;if("Start"==t||"Finish"==t||"boolean"===t||"int"===t||"float"===t||"string"===t);else{let t="c_"+e,n=l[e].name;n=n.replace(/\s+/g,""),r+="    "+t+" = "+n+"()\n"}}if(r+="\n",a){let e=a.getID(),t=0;for(;null!=Ve(o.getLinks(),e);){let n=Ve(o.getLinks(),e);if(n){let o="c_"+ ++t,a=Ge(i,n),s=a.getPorts();for(let e in s)if("left"==s[e].getOptions().alignment){let t=s[e].getOptions().label;if(t=t.replace(/\s+/g,"_"),t=t.toLowerCase(),t.startsWith("★")){const e=t.split("★")[1];t=e}if("▶"==t);else{let n=s[e].getLinks();for(let i in n){let a=n[i].getSourcePort().getNode().name,c=n[i].getSourcePort().getNode().getOptions().extras.type,d=n[i].getSourcePort().getNode().getOptions().id,u=n[i].getSourcePort().getOptions().label,g="c_"+Ue(l,d),p=s[e].links[i].sourcePort.parent.options.id;if(e.startsWith("parameter"))if(a.startsWith("Literal"))r+="string"==c?"    "+o+"."+t+".value = '"+u+"'\n":"list"==c?"    "+o+"."+t+".value = ["+u+"]\n":"tuple"==c?"    "+o+"."+t+".value = ("+u+")\n":"dict"==c?"    "+o+"."+t+".value = {"+u+"}\n":"    "+o+"."+t+".value = "+u+"\n";else if(p!=d||a.startsWith("Hyperparameter")){u=u.replace(/\s+/g,"_"),u=u.toLowerCase(),a=a.split(": ");let e=a[a.length-1];e=e.replace(/\s+/g,"_"),e=e.toLowerCase(),r+="    "+o+"."+t+".value = args."+e+"\n"}else r+="    "+o+"."+t+" = "+g+"."+u+"\n";else r+="    "+o+"."+t+" = "+g+"."+u+"\n"}}}a&&(e=a.getID())}}}r+="\n";for(let e=0;e<l.length;e++){let t=l[e].extras.type,n="c_"+e,o="c_"+(e+1);"Start"==t||"Finish"==t||(e==l.length-2?r+="    "+n+".next = None\n":r+="    "+n+".next = "+o+"\n")}if(r+="    debug_mode = args.debug_mode\n",l.length>2){if(r+="\n",r+="    next_component = c_1\n",r+="    while next_component:\n",r+="        if debug_mode:\n",r+="            if len(continue_input_data) > 0 and continue_input_data[-1] == 'continue':\n",r+="                vars_dict = vars(next_component)\n",r+="                new_dict = {}\n",r+="                for i in vars_dict:\n",r+="                    if not i in ['next', 'done']:\n",r+="                        new_dict[i] = next_component.__getattribute__(i).value\n",r+="                        if 'InArg' in str(vars_dict[i]):\n",r+="                            inarg_output_data.append(str(i) + ': ' + str(next_component.__getattribute__(i).value))\n",r+="                        if 'OutArg' in str(vars_dict[i]):\n",r+="                            outarg_output_data.append(str(i) + ': ' + str(next_component.__getattribute__(i).value))\n",r+="                continue_input_data.clear()\n",r+="\n",r+="            if len(input_data) > 0 and input_data[-1] == 'run':\n",r+="                is_done, next_component = next_component.do(ctx)\n",r+="                input_data.clear()\n",r+="                is_done_list.append(is_done)\n",r+="\n",r+="            if len(input_data) > 0 and input_data[-1] == 'skip':\n",r+="                is_done, next_component = next_component.do(ctx)\n",r+="\n",r+="        else:\n",r+="            is_done, next_component = next_component.do(ctx)\n",r+="\n",r+="@app.route('/terminate')\n",r+="def shutdown():\n",r+="    os.kill(os.getpid(), signal.SIGINT)\n",r+='    return jsonify({ "success": True, "message": "Server is shutting down..." })\n\n',r+="@app.route('/run')\n",r+="def next_node(input_data=input_data):\n",r+='    input_data.append("run")\n',r+='    return jsonify({ "success": True, "message": "Run is executed" })\n\n',r+="@app.route('/execute')\n",r+="def get_execution_output():\n",r+="    return str(is_done_list)\n\n",r+="@app.route('/clear_execution')\n",r+="def clear_execution_output():\n",r+="    is_done_list.clear()\n",r+='    return jsonify({ "success": True, "message": "Clearing execution" })\n\n',r+="@app.route('/continue')\n",r+="def continue_node(continue_input_data=continue_input_data):\n",r+='    continue_input_data.append("continue")\n',r+='    return jsonify({ "success": True, "message": "Continue is executed" })\n\n',r+="@app.route('/clear')\n",r+="def clear_node():\n",r+="    inarg_output_data.clear()\n",r+="    outarg_output_data.clear()\n",r+='    return jsonify({ "success": True, "message": "Clearing input/output args" })\n\n',r+="@app.route('/get/output')\n",r+="def get_output_data():\n",r+="    inarg_output = ''\n",r+="    if inarg_output_data != []:\n",r+="        inarg_output = 'InArg -> '\n",r+="        inarg_output += '\t'.join(inarg_output_data)\n\n",r+="    outarg_output = ''\n",r+="    if outarg_output_data != []:\n",r+="        outarg_output = 'OutArg -> '\n",r+="        outarg_output += '\t'.join(outarg_output_data)\n\n",r+="    return (str(inarg_output) + ' ' + str(outarg_output)).strip()\n\n",r+="if __name__ == '__main__':\n",r+="    parser = ArgumentParser()\n",le)for(let e=0;e<le.length;e++){let t=le[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="experiment_name"==t?"    parser.add_argument('--"+t+"', default=datetime.now().strftime('%Y-%m-%d %H:%M:%S'), type=str)\n":"    parser.add_argument('--"+t+"', default='test', type=str)\n"}if(de)for(let e=0;e<de.length;e++){let t=de[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="    parser.add_argument('--"+t+"', default='1', type=int)\n"}if(ge)for(let e=0;e<ge.length;e++){let t=ge[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="    parser.add_argument('--"+t+"', default='1.0', type=float)\n"}if(me)for(let e=0;e<me.length;e++){let t=me[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="    parser.add_argument('--"+t+"', default=True, type=bool)\n"}r+="    parser.add_argument('--debug_mode', default=False, type=bool)\n\n",r+="    debug_mode = parser.parse_args().debug_mode\n",r+="    if debug_mode:\n",r+="        thread = Thread(target=app.run, daemon=True)\n",r+="        thread.start()\n\n",r+="    main(parser.parse_args())\n",r+='    print("\\nFinish Executing")'}return r},Qe=()=>{let e=t.getDiagramEngine().getModel().getNodes();for(let t=0;t<e.length;t++){let n=e[t].portsIn,o=0;if(0!=n){if("▶"==n[o].getOptions().label&&0!=Object.keys(n[0].getLinks()).length)continue;return e[t].getOptions().extras.borderColor="red",e[t].getOptions().extras.tip="Please make sure this node ▶ is properly connected ",e[t].setSelected(!0),!1}}return!0},Ye=()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&($e(),Q(!0),J(!0),r.execute($.saveDocManager))},Ze=async t=>{if(Re.current.model.dirty){const e=await(0,m.showDialog)({title:"This xircuits contains unsaved changes.",body:"To run the xircuits the changes need to be saved.",buttons:[m.Dialog.cancelButton(),m.Dialog.okButton({label:"Save and Run"})]});if(!e.button||!0!==e.button.accept)return;await Ye()}let n=Qe(),o=(()=>{let e=Ke();for(let t=0;t<e.length;t++)for(let n=0;n<e[t].portsIn.length;n++){let o=e[t].portsIn[n];if(o.getOptions().label.startsWith("★")&&0==Object.keys(o.getLinks()).length)return e[t].getOptions().extras.borderColor="red",e[t].getOptions().extras.tip="Please make sure the [★]COMPULSORY InPorts are connected ",e[t].setSelected(!0),!1}return!0})();if(!n)return Ie?void alert("Please connect all the nodes before debugging."):void alert("Please connect all the nodes before running.");if(!o)return void alert("Please connect all [★]COMPULSORY InPorts.");let i=qe();if("run-dont-compile"!=ze&&(r.execute($.createArbitraryFile,{pythonCode:i,showOutput:!1}),K(!0)),t){const e=await at(),t="--debug_mode True";if(e){r.execute($.executeToOutputPanel,{runCommand:e,debug_mode:t}),r.execute($.openDebugger),Le(!0),Te(!1);let n=Ke();n.forEach((e=>{e.setSelected(!1)})),We(0),n[0].setSelected(!0)}}else e.ready.then((async()=>{let e=await at(),t=e.commandStr,n=e.addArgs;e&&r.execute($.executeToOutputPanel,{runCommand:t,runType:ze,addArgsSparkSubmit:n})}))};function et(e){return new Promise((t=>setTimeout(t,e)))}const tt=async()=>(await nt("clear"),await nt("continue"),await nt("get/output"));async function nt(e){const t={command:e};try{return await _("debug/enable",{body:JSON.stringify(t),method:"POST"})}catch(e){console.error(`Error on POST /xircuit/debug/enable ${t}.\n${e}`)}}const ot=async()=>{if(!Ie)return void alert("Not in debug mode");let e,t,n=Ke(),o=Ae;if(t=n[o],e=n[o],t.getOptions().name.startsWith("🔴")){if(e.setSelected(!0),e.getOptions().color="rgb(150,150,150)",t=n[o+1],t.getOptions().name.startsWith("🔴")){if("🔴Start"!=t.getOptions().name&&"Start"!=t.getOptions().name){await nt("run");let e=await nt("get_run"),n=void 0===e.output?"":e.output;for(;n.split(",").length!=o;)await et(1500),e=await nt("get_run"),n=void 0===e.output?"":e.output;await tt(),await et(1e3);let i=await nt("get/output"),a=t;w.emit({item:a,item2:i})}await et(1e3),e.setSelected(!1),t.setSelected(!0),"Finish"!=t.getOptions().name&&"🔴Finish"!=t.getOptions().name&&(o+=1,t=n[o],We(o))}await et(1e3),e.setSelected(!1)}for(;!t.getOptions().name.startsWith("🔴");){if(e=t,e.setSelected(!0),e.getOptions().color="rgb(150,150,150)","Start"!=t.getOptions().name&&"🔴Start"!=t.getOptions().name){await et(1e3),e.setSelected(!1),t.setSelected(!0),await nt("run");let n=await nt("get_run"),i=void 0===n.output?"":n.output;for(;i.split(",").length!=o;)await et(1500),n=await nt("get_run"),i=void 0===n.output?"":n.output}if(await et(1e3),e.setSelected(!1),e=t,o+=1,t=n[o],t.setSelected(!0),Te(!0),"Finish"==t.getOptions().name||"🔴Finish"==t.getOptions().name)return e.setSelected(!1),t.setSelected(!0),t.getOptions().color="rgb(150,150,150)",await et(1e3),t.setSelected(!1),alert("Finish Execution."),We(-1),Le(!1),Te(!1),void n.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color}));We(o),await tt(),await et(1e3);let i=await nt("get/output"),a=t;w.emit({item:a,item2:i})}"Finish"!=t.getOptions().name&&"🔴Finish"!=t.getOptions().name||(await et(1e3),e.setSelected(!1),t.setSelected(!0),t.getOptions().color="rgb(150,150,150)",We(-1),Le(!1),Te(!1),alert("Finish Execution."),n.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color})))},it=e=>{let t=Ke();if(e)return t.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color,e.setSelected(!1)})),void t[0].setSelected(!0);t.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color}))};(0,o.useEffect)((()=>{se("spark-submit"==ze?"Added Arguments":""),e.ready.then((()=>{if(q){let e=t.getDiagramEngine().getModel().getNodes(),n=e.length;for(let t=0;t<n;t++){let n=e[t].getOptions().name;if(n.startsWith("Hyperparameter")){let e=/\(([^)]+)\)/,t=n.match(e),o=n.split(": ");"String"==t[1]?ce((e=>[...e,o[o.length-1]].sort())):"Int"==t[1]?ue((e=>[...e,o[o.length-1]].sort())):"Float"==t[1]?pe((e=>[...e,o[o.length-1]].sort())):"Boolean"==t[1]&&he((e=>[...e,o[o.length-1]].sort()))}}}else ce(["experiment name"]),ue([]),pe([]),he([])}))}),[q,ze]);const at=async()=>{var e;const t={title:"Run",body:M(i().createElement(F,{childSparkSubmitNodes:re,childStringNodes:le,childBoolNodes:me,childIntNodes:de,childFloatNodes:ge})),buttons:[m.Dialog.cancelButton(),m.Dialog.okButton({label:"Start"})],defaultButton:1,focusNodeSelector:"#name"},n=await(async(e,t)=>{var n,o,i,a;const r=e.body,s=new m.Dialog(e);if(r instanceof P.Widget){const t=r.node.querySelectorAll("[data-form-required]");if(t&&t.length>0){const r=new Set,l=s.handleEvent;s.handleEvent=e=>{e instanceof KeyboardEvent&&"keydown"===e.type&&13===e.keyCode&&r.size!==t.length?(e.stopPropagation(),e.preventDefault()):l.call(s,e)};const c=null!==(n=e.defaultButton)&&void 0!==n?n:(null!==(i=null===(o=e.buttons)||void 0===o?void 0:o.length)&&void 0!==i?i:0)-1,d=null===(a=s.node.querySelector(".jp-Dialog-footer"))||void 0===a?void 0:a.getElementsByTagName("button")[c];t.forEach((e=>{I(e,r);const n=e.tagName.toLowerCase();"select"===n?e.addEventListener("change",(e=>{I(e.target,r),L(r,t,d)})):"input"!==n&&"textarea"!==n||e.addEventListener("keyup",(e=>{I(e.target,r),L(r,t,d)}))})),L(r,t,d)}}return s.launch()})(t);if("Cancel"==n.button.label)return!1;let o=" ",a=null!==(e=n.value[re])&&void 0!==e?e:"";return le.forEach((e=>{if("experiment name"==e){var t=new Date;let n=`${t.getFullYear().toString().padStart(4,"0")}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`;Be.info(e+": "+n)}else if(n.value[e]){Be.info(e+": "+n.value[e]);let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),me&&me.forEach((e=>{if(Be.info(e+": "+n.value[e]),n.value[e]){let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),de&&de.forEach((e=>{if(Be.info(e+": "+n.value[e]),n.value[e]){let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),ge&&ge.forEach((e=>{if(Be.info(e+": "+n.value[e]),n.value[e]){let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),{commandStr:o,addArgs:a}};[[d,Ye],[p,()=>{var e;if((null===(e=a.currentWidget)||void 0===e?void 0:e.id)!==l)return;let t=Qe();if(!V)return void alert("Please save before compiling.");if(!t)return void alert("Please connect all the nodes before compiling.");let n=qe();K(!0),r.execute($.createArbitraryFile,{pythonCode:n,showOutput:!0})}],[h,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&Ze(!1)}],[f,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&(it(!0),Ze(!0))}],[v,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&Ke().forEach((e=>{const t=e.getOptions().name;e.isLocked()||"Start"!==t&&"Finish"!==t&&(e.setSelected(!0),e.setLocked(!0))}))}],[S,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&t.getDiagramEngine().getModel().getNodes().forEach((e=>{if(1==e.getOptions().selected){let t=e.getOptions().name;t.startsWith("🔴")?e.getOptions().name=t.split("🔴")[1]:e.getOptions().name="🔴"+t,e.setSelected(!0),e.setSelected(!1)}}))}],[y,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Testing")}],[E,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&(0==Ae&&it(!0),await ot())}],[O,async()=>{var e;if((null===(e=a.currentWidget)||void 0===e?void 0:e.id)!==l)return;if(!Ie)return void alert("Not in debug mode");let t,n,o=Ke(),i=Ae;if(t=o[i],n=o[i],"Start"==t.getOptions().name||"🔴Start"==t.getOptions().name){t.setSelected(!0),await tt(),t.getOptions().color="rgb(150,150,150)",t.setSelected(!1),i+=1,t=o[i],t.setSelected(!0),n.setSelected(!1),We(i),await et(1500);let e=await nt("get/output");await et(1e3);let a=t;w.emit({item:a,item2:e})}else{await nt("run");let e=await nt("get_run"),a=void 0===e.output?"":e.output;for(;a.split(",").length!=i;)await et(1500),e=await nt("get_run"),a=void 0===e.output?"":e.output;await tt(),n.setSelected(!0),i+=1,t=o[i],t.setSelected(!0),n.getOptions().color="rgb(150,150,150)",n.setSelected(!1),We(i),await et(1500);let r=await nt("get/output"),s=t;w.emit({item:s,item2:r})}"Finish"==t.getOptions().name&&(t.getOptions().color="rgb(150,150,150)",t.setSelected(!1),t.setSelected(!0),We(-1),Le(!1),Te(!1),o.forEach((e=>{e.getOptions().color="rgb(150,150,150)",e.setSelected(!1),e.setSelected(!0),e.getOptions().color=e.color})),alert("Finish Execution."))}],[C,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&(0==Ae&&it(!0),await ot())}],[D,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&Ie&&(it(!1),(async()=>{await nt("terminate")})(),We(-1),Le(!1),Te(!1),alert("Execution has been terminated."))}],[X,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Step In")}],[T,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Step Out")}],[A,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Evaluate Code")}]].forEach((([e,t])=>{(0,o.useEffect)((()=>(e.connect(t),()=>{e.disconnect(t)})),[e,t])}));const rt=async()=>{const e=await N();e.length>0&&Oe([]),Oe(e)};return(0,o.useEffect)((()=>{let e;x.connect(((t,n)=>{e=n.runType,Fe(e)}))}),[x]),(0,o.useEffect)((()=>{W.emit({debugMode:Ie,inDebugMode:Xe})}),[Ie,Xe]),(0,o.useEffect)((()=>{Ce||rt()}),[]),(0,o.useEffect)((()=>{const e=setInterval((()=>{rt()}),5e3);return()=>clearInterval(e)}),[ke]),i().createElement(B,null,i().createElement(R,null,i().createElement(j,{onDrop:e=>{var n=JSON.parse(e.dataTransfer.getData("storm-diagram-node"));let o,i=ke.map((e=>e.task)).indexOf(n.name),a=null;if(-1!=i&&(o=ke[i]),null!=o)if("GENERAL"==o.header)if("math"===n.type)a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("A","in-1"),a.addInPortEnhance("B","in-2"),a.addOutPortEnhance("▶","out-0"),a.addOutPortEnhance("value","out-1");else if("convert"===n.type)a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("model","parameter-string-in-1"),a.addOutPortEnhance("▶","out-0"),a.addOutPortEnhance("converted","out-1");else if("string"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter String Value (Without Quotes):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter String Name (Without Quotes):");a=new b({name:"Hyperparameter (String): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("int"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Int Value (Without Quotes):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Int Name (Without Quotes):");a=new b({name:"Hyperparameter (Int): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("float"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Float Value (Without Quotes):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Float Name (Without Quotes):");a=new b({name:"Hyperparameter (Float): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("boolean"===n.type)if(n.name.startsWith("Literal")){let e=n.name.split(" ");e=e[e.length-1],a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Boolean Name (Without Quotes):");a=new b({name:"Hyperparameter (Boolean): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("list"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter List Values (Without [] Brackets):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter List Name (Without Quotes):");a=new b({name:"Hyperparameter (List): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("tuple"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Tuple Values (Without () Brackets):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Tuple Name (Without Quotes):");a=new b({name:"Hyperparameter (Tuple): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("dict"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Dict Values (Without {} Brackets):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Dict Name (Without Quotes):");a=new b({name:"Hyperparameter (Dict): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else"debug"===n.type?(a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("Data Set","parameter-in-1"),a.addOutPortEnhance("▶","out-0")):"enough"===n.type?(a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("Target Accuracy","parameter-float-in-1"),a.addInPortEnhance("Max Retries","parameter-int-in-2"),a.addInPortEnhance("Metrics","parameter-string-in-3"),a.addOutPortEnhance("▶","out-0"),a.addOutPortEnhance("Should Retrain","out-1")):"literal"===n.type&&(a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("Value","out-0"));else if("ADVANCED"==o.header){a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addOutPortEnhance("▶","out-0");let e={bool:"boolean",str:"string"};o.variables.forEach((t=>{let n=t.name,o=e[t.type]||t.type;switch(t.kind){case"InCompArg":a.addInPortEnhance(`★${n}`,`parameter-${o}-${n}`);break;case"InArg":a.addInPortEnhance(n,`parameter-${o}-${n}`);break;case"OutArg":a.addOutPortEnhance(n,`parameter-out-${o}-${n}`);break;default:console.warn("Unknown variable kind for variable",t)}}))}if(null!=a){let n=t.getDiagramEngine().getRelativeMousePoint(e);a.setPosition(n),t.getDiagramEngine().getModel().addNode(a),a.name.startsWith("Hyperparameter")&&Q(!0),J(!1),K(!1),U()}},onDragOver:e=>{e.preventDefault()},onMouseOver:e=>{e.preventDefault()},onMouseUp:e=>{e.preventDefault()},onMouseDown:e=>{e.preventDefault()}},i().createElement(u,null,i().createElement(s.CanvasWidget,{engine:t.getDiagramEngine()})))))};var U,V=n(32581),J=n(26194),G=n(6168),K=n(96486),q=(n(96315),n(88907)),Q=n.n(q),Y=n(62880),Z=n.n(Y),ee=n(59982),te=(n(54467),n(82067)),ne=n.n(te);!function(e){e.Node=c().div`
		background-color: ${e=>e.background};
		border-radius: 5px;
		font-family: sans-serif;
		color: white;
		border: solid 2px black;
		overflow: visible;
		font-size: 11px;
		border: solid 2px ${e=>e.selected?null==e.borderColor?"rgb(0,192,255)":e.borderColor:"black"};
	`,e.Title=c().div`
		background: rgba(0, 0, 0, 0.3);
		display: flex;
		white-space: nowrap;
		justify-items: center;
	`,e.TitleName=c().div`
		flex-grow: 1;
		padding: 5px 5px;
	`,e.Ports=c().div`
		display: flex;
		background-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));
	`,e.PortsContainer=c().div`
		flex-grow: 1;
		display: flex;
		flex-direction: column;

		&:first-of-type {
			margin-right: 10px;
		}

		&:only-child {
			margin-right: 0px;
		}
	`,e.ImageGalleryContainer=c().div`
		width: 600px;
		height: 440px;
	`}(U||(U={}));class oe extends o.Component{constructor(){super(...arguments),this.generatePort=e=>o.createElement(g.DefaultPortLabel,{engine:this.props.engine,port:e,key:e.getID()}),this.state={isTooltipActive:!1,nodeDeletable:!1,imageGalleryItems:[{original:"https://picsum.photos/id/1018/1000/600/",thumbnail:"https://picsum.photos/id/1018/250/150/"},{original:"https://picsum.photos/id/1015/1000/600/",thumbnail:"https://picsum.photos/id/1015/250/150/"},{original:"https://picsum.photos/id/1019/1000/600/",thumbnail:"https://picsum.photos/id/1019/250/150/"}]},this.onPageChanged=e=>{console.log(e.currentPage),this.props.node.getOptions().extras.imageGalleryItems}}showTooltip(){this.setState({isTooltipActive:!0})}hideTooltip(){this.setState({isTooltipActive:!1})}handleClose(){delete this.props.engine.getModel().getNodes()[1].getOptions().extras.imageGalleryItems,this.hideTooltip()}handleDeletableNode(e,t){this.setState({[e]:t.target.checked?this.props.node.setLocked(!0):this.props.node.setLocked(!1)})}handleEditLiteral(){this.props.node.getOptions().name.startsWith("Literal")&&this.props.app.commands.execute($.editNode)}render(){return null!=this.props.node.getOptions().extras.tip&&""!=this.props.node.getOptions().extras.tip?o.createElement(U.Node,{onMouseEnter:this.showTooltip.bind(this),onMouseLeave:this.hideTooltip.bind(this),ref:e=>{this.element=e},borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color},o.createElement(Z(),{active:this.state.isTooltipActive,position:"top",arrow:"center",parent:this.element},o.createElement("p",null,this.props.node.getOptions().extras.tip)),o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name),o.createElement("label",null,o.createElement(ne(),{className:"lock",checked:this.props.node.isLocked(),onChange:this.handleDeletableNode.bind(this,"nodeDeletable")}))),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,K.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,K.map(this.props.node.getOutPorts(),this.generatePort)))):null!=this.props.node.getOptions().extras.imageGalleryItems?o.createElement(U.Node,{onMouseEnter:this.showTooltip.bind(this),onMouseLeave:this.hideTooltip.bind(this),ref:e=>{this.element=e},borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color},o.createElement(Z(),{active:this.state.isTooltipActive,position:"top",arrow:"center",parent:this.element},o.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.handleClose.bind(this)},o.createElement("span",{"aria-hidden":"true"},"×")),o.createElement(U.ImageGalleryContainer,null,o.createElement(Q(),{items:this.state.imageGalleryItems})),o.createElement(ee.Pagination,{totalRecords:100,pageLimit:5,pageNeighbours:1,onPageChanged:this.onPageChanged})),o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name)),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,K.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,K.map(this.props.node.getOutPorts(),this.generatePort)))):"Start"!==this.props.node.getOptions().name&&"Finish"!==this.props.node.getOptions().name?o.createElement(U.Node,{borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color,onDoubleClick:this.handleEditLiteral.bind(this)},o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name),o.createElement("label",null,o.createElement(ne(),{className:"lock",checked:this.props.node.isLocked(),onChange:this.handleDeletableNode.bind(this,"nodeDeletable")}))),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,K.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,K.map(this.props.node.getOutPorts(),this.generatePort)))):o.createElement(U.Node,{borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color},o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name)),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,K.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,K.map(this.props.node.getOutPorts(),this.generatePort))))}}class ie extends s.AbstractReactFactory{constructor(e){super("custom-node"),this.app=e}generateModel(e){return new b}generateReactWidget(e){return o.createElement(oe,{engine:this.engine,node:e.model,app:this.app})}}class ae extends s.Action{constructor(e){super({type:s.InputType.KEY_DOWN,fire:t=>{const n=e.app,o=t.event.key,i=t.event.ctrlKey;i&&"z"===o&&n.commands.execute($.undo),i&&"y"===o&&n.commands.execute($.redo),i&&"s"===o&&n.commands.execute($.saveXircuit),"Delete"!=o&&"Backspace"!=o||n.commands.execute($.deleteNode)}})}}class re{constructor(e){this.diagramEngine=p()({registerDefaultZoomCanvasAction:!1,registerDefaultDeleteItemsAction:!1}),this.activeModel=new g.DiagramModel,this.diagramEngine.getNodeFactories().registerFactory(new ie(e)),this.diagramEngine.getActionEventBus().registerAction(new s.ZoomCanvasAction({inverseZoom:!0})),this.diagramEngine.getActionEventBus().registerAction(new ae({app:e}));let t=new b({name:"Start",color:"rgb(255,102,102)",extras:{type:"Start"}});t.addOutPortEnhance("▶","out-0"),t.addOutPortEnhance("  ","parameter-out-1"),t.setPosition(100,100);let n=new b({name:"Finish",color:"rgb(255,102,102)",extras:{type:"Finish"}});n.addInPortEnhance("▶","in-0"),n.addInPortEnhance("  ","parameter-in-1"),n.setPosition(700,100),this.activeModel.addAll(t,n),this.diagramEngine.setModel(this.activeModel)}getActiveDiagram(){return this.activeModel}getDiagramEngine(){return this.diagramEngine}}class se extends m.ReactWidget{constructor(e){super(e),this.app=e.app,this.shell=e.shell,this.commands=e.commands,this.context=e.context,this.serviceManager=e.serviceManager,this.saveXircuitSignal=e.saveXircuitSignal,this.compileXircuitSignal=e.compileXircuitSignal,this.runXircuitSignal=e.runXircuitSignal,this.runTypeXircuitSignal=e.runTypeXircuitSignal,this.debugXircuitSignal=e.debugXircuitSignal,this.lockNodeSignal=e.lockNodeSignal,this.breakpointXircuitSignal=e.breakpointXircuitSignal,this.currentNodeSignal=e.currentNodeSignal,this.testXircuitSignal=e.testXircuitSignal,this.continueDebugSignal=e.continueDebugSignal,this.nextNodeDebugSignal=e.nextNodeDebugSignal,this.stepOverDebugSignal=e.stepOverDebugSignal,this.terminateDebugSignal=e.terminateDebugSignal,this.stepInDebugSignal=e.stepInDebugSignal,this.stepOutDebugSignal=e.stepOutDebugSignal,this.evaluateDebugSignal=e.evaluateDebugSignal,this.debugModeSignal=e.debugModeSignal,this.xircuitsApp=new re(this.app)}handleEvent(e){if("mouseup"===e.type)this.node.focus(),this.node.addEventListener("blur",this,!0);else if("blur"===e.type){const e=e=>e.setSelected(!1),t=this.xircuitsApp.getDiagramEngine().getModel();t.getNodes().forEach(e),t.getLinks().forEach(e)}else"contextmenu"===e.type&&this.node.removeEventListener("blur",this,!0)}onAfterAttach(e){this.node.addEventListener("mouseup",this,!0),this.node.addEventListener("blur",this,!0),this.node.addEventListener("contextmenu",this,!0)}onBeforeDetach(){this.node.removeEventListener("mouseup",this,!0),this.node.removeEventListener("blur",this,!0),this.node.removeEventListener("contextmenu",this,!0)}render(){var e;return i().createElement(H,{context:this.context,xircuitsApp:this.xircuitsApp,app:this.app,shell:this.shell,commands:this.commands,widgetId:null===(e=this.parent)||void 0===e?void 0:e.id,serviceManager:this.serviceManager,saveXircuitSignal:this.saveXircuitSignal,compileXircuitSignal:this.compileXircuitSignal,runXircuitSignal:this.runXircuitSignal,runTypeXircuitSignal:this.runTypeXircuitSignal,debugXircuitSignal:this.debugXircuitSignal,lockNodeSignal:this.lockNodeSignal,breakpointXircuitSignal:this.breakpointXircuitSignal,currentNodeSignal:this.currentNodeSignal,testXircuitSignal:this.testXircuitSignal,continueDebugSignal:this.continueDebugSignal,nextNodeDebugSignal:this.nextNodeDebugSignal,stepOverDebugSignal:this.stepOverDebugSignal,terminateDebugSignal:this.terminateDebugSignal,stepInDebugSignal:this.stepInDebugSignal,stepOutDebugSignal:this.stepOutDebugSignal,evaluateDebugSignal:this.evaluateDebugSignal,debugModeSignal:this.debugModeSignal})}}class le extends m.ReactWidget{constructor(e){super(),this.handleChange=e=>{let t=e.target.value;this._output.runTypeXircuitSignal.emit({runType:t}),this.update()},this._output=e}render(){return i().createElement(m.UseSignal,{signal:this._output.runTypeXircuitSignal},((e,t)=>{if(void 0!==t){let e=t.runType;return i().createElement(x.HTMLSelect,{onChange:this.handleChange,value:e,"aria-label":"Run type",title:"Select the run type"},i().createElement("option",{value:"run"},"Run"),i().createElement("option",{value:"run-dont-compile"},"Run w/o Compile"),i().createElement("option",{value:"spark-submit"},"Spark Submit"))}return i().createElement(x.HTMLSelect,{onChange:this.handleChange,value:void 0,"aria-label":"Run type",title:"Select the run type"},i().createElement("option",{value:"run"},"Run"),i().createElement("option",{value:"run-dont-compile"},"Run w/o Compile"),i().createElement("option",{value:"spark-submit"},"Spark Submit"))}))}}const ce=new x.LabIcon({name:"xircuits:xircuits",svgstr:'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- Generator: Adobe Illustrator 25.0.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 270 250" style="enable-background:new 0 0 270 250;" xml:space="preserve">\n<style type="text/css">\n\t.st0{fill:#3EA5BD;}\n\t.st1{fill:#324057;}\n</style>\n<g>\n\t<g>\n\t\t<g>\n\t\t\t<path class="st0" d="M27.6,5.6c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S34.7,5.6,27.6,5.6z"/>\n\t\t\t<path class="st0" d="M63,5.6c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S70.2,5.6,63,5.6z"/>\n\t\t\t<path class="st0" d="M27.6,41c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S34.7,41,27.6,41z"/>\n\t\t\t<path class="st0" d="M63,41c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S70.2,41,63,41z"/>\n\t\t\t<path class="st0" d="M27.6,76.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C40.5,82.3,34.7,76.5,27.6,76.5z"/>\n\t\t\t<path class="st0" d="M63,76.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C76,82.3,70.2,76.5,63,76.5z"/>\n\t\t\t<path class="st0" d="M63,112c-7.2,0-13,5.8-13,13c0,7.2,5.8,13,13,13s13-5.8,13-13S70.2,112,63,112z"/>\n\t\t\t<path class="st0" d="M27.6,147.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C40.5,153.3,34.7,147.5,27.6,147.5z"/>\n\t\t\t<path class="st0" d="M63,147.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C76,153.3,70.2,147.5,63,147.5z"/>\n\t\t\t<path class="st0" d="M27.6,183c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S34.7,183,27.6,183z"/>\n\t\t\t<path class="st0" d="M63,183c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S70.2,183,63,183z"/>\n\t\t\t<path class="st0" d="M27.6,218.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S34.7,218.5,27.6,218.5z"/>\n\t\t\t<path class="st0" d="M63,218.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13S70.2,218.5,63,218.5z"/>\n\t\t\t<path class="st0" d="M98.5,41c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C111.5,46.9,105.7,41,98.5,41z"/>\n\t\t\t<path class="st0" d="M98.5,76.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C111.5,82.3,105.7,76.5,98.5,76.5z"/>\n\t\t\t<path class="st0" d="M98.5,147.5c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C111.5,153.3,105.7,147.5,98.5,147.5z"/>\n\t\t\t<path class="st0" d="M98.5,183c-7.2,0-13,5.8-13,13s5.8,13,13,13s13-5.8,13-13C111.5,188.8,105.7,183,98.5,183z"/>\n\t\t</g>\n\t\t<g>\n\t\t\t<path class="st1" d="M240.5,244.4c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S233.3,244.4,240.5,244.4z"/>\n\t\t\t<path class="st1" d="M205,244.4c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S197.8,244.4,205,244.4z"/>\n\t\t\t<path class="st1" d="M240.5,208.9c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S233.3,208.9,240.5,208.9z"/>\n\t\t\t<path class="st1" d="M205,208.9c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C192,203.1,197.8,208.9,205,208.9z"/>\n\t\t\t<path class="st1" d="M240.5,173.5c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C227.5,167.6,233.3,173.5,240.5,173.5z"/>\n\t\t\t<path class="st1" d="M205,173.5c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C192,167.6,197.8,173.5,205,173.5z"/>\n\t\t\t<path class="st1" d="M205,138c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C192,132.2,197.8,138,205,138z"/>\n\t\t\t<path class="st1" d="M240.5,102.5c7.2,0,13-5.8,13-13c0-7.2-5.8-13-13-13s-13,5.8-13,13C227.5,96.7,233.3,102.5,240.5,102.5z"/>\n\t\t\t<path class="st1" d="M205,102.5c7.2,0,13-5.8,13-13c0-7.2-5.8-13-13-13s-13,5.8-13,13C192,96.7,197.8,102.5,205,102.5z"/>\n\t\t\t<path class="st1" d="M240.5,67c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S233.3,67,240.5,67z"/>\n\t\t\t<path class="st1" d="M205,67c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C192,61.2,197.8,67,205,67z"/>\n\t\t\t<path class="st1" d="M240.5,31.5c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S233.3,31.5,240.5,31.5z"/>\n\t\t\t<path class="st1" d="M205,31.5c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S197.8,31.5,205,31.5z"/>\n\t\t\t<path class="st1" d="M169.5,208.9c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S162.3,208.9,169.5,208.9z"/>\n\t\t\t<path class="st1" d="M169.5,173.5c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C156.5,167.6,162.3,173.5,169.5,173.5z"/>\n\t\t\t<path class="st1" d="M169.5,138c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S162.3,138,169.5,138z"/>\n\t\t\t<path class="st1" d="M169.5,102.5c7.2,0,13-5.8,13-13c0-7.2-5.8-13-13-13s-13,5.8-13,13C156.5,96.7,162.3,102.5,169.5,102.5z"/>\n\t\t\t<path class="st1" d="M169.5,67c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13S162.3,67,169.5,67z"/>\n\t\t\t<path class="st1" d="M134,173.5c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C121,167.6,126.8,173.5,134,173.5z"/>\n\t\t\t<path class="st1" d="M134,138c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C121,132.2,126.8,138,134,138z"/>\n\t\t\t<path class="st1" d="M134,102.5c7.2,0,13-5.8,13-13c0-7.2-5.8-13-13-13s-13,5.8-13,13C121,96.7,126.8,102.5,134,102.5z"/>\n\t\t\t<path class="st1" d="M98.5,138c7.2,0,13-5.8,13-13s-5.8-13-13-13s-13,5.8-13,13C85.6,132.2,91.4,138,98.5,138z"/>\n\t\t</g>\n\t</g>\n</g>\n</svg>\n'}),de=new x.LabIcon({name:"xircuits:debuggerIcon",svgstr:'<svg height=\'100px\' width=\'100px\' class="jp-icon3"  fill="#616161" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" \n     viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">\n    <path d="M87,15H13c-3.314,0-6,2.686-6,6v58c0,3.314,2.686,6,6,6h74c3.314,0,6-2.686,6-6V21C93,17.686,90.314,15,87,15z M80,19  c1.657,0,3,1.343,3,3s-1.343,3-3,3s-3-1.343-3-3S78.343,19,80,19z M68,19c1.657,0,3,1.343,3,3s-1.343,3-3,3s-3-1.343-3-3  S66.343,19,68,19z M56,19c1.657,0,3,1.343,3,3s-1.343,3-3,3s-3-1.343-3-3S54.343,19,56,19z M87,78c0,0.552-0.448,1-1,1H14  c-0.552,0-1-0.448-1-1V30c0-0.552,0.448-1,1-1h72c0.552,0,1,0.448,1,1V78z"></path>\n    <path d="M71,56h-5.678c-0.249,0-0.454-0.186-0.488-0.433c-0.142-1.026-0.374-2.016-0.693-2.961  c-0.076-0.225,0.012-0.469,0.218-0.587l4.828-2.787c2.293-1.324,0.288-4.785-2-3.464l-4.69,2.708  c-0.215,0.124-0.484,0.067-0.637-0.129c-0.993-1.267-2.208-2.356-3.632-3.213c-0.141-0.085-0.227-0.234-0.232-0.398  c-0.041-1.252-0.375-2.428-0.929-3.47c-0.103-0.195-0.075-0.43,0.081-0.585l2.266-2.266c1.869-1.869-0.958-4.699-2.828-2.828  l-2.267,2.267c-0.155,0.155-0.391,0.183-0.586,0.08c-2.344-1.244-5.123-1.244-7.467,0c-0.194,0.103-0.43,0.075-0.586-0.08  l-2.267-2.267c-1.869-1.869-4.699,0.958-2.828,2.828l2.266,2.266c0.156,0.156,0.184,0.391,0.081,0.585  c-0.553,1.042-0.887,2.218-0.929,3.47c-0.005,0.164-0.091,0.314-0.232,0.398c-1.425,0.857-2.64,1.946-3.632,3.213  c-0.153,0.196-0.422,0.253-0.637,0.129l-4.69-2.708c-2.288-1.321-4.292,2.141-2,3.464l4.828,2.787  c0.206,0.119,0.294,0.363,0.218,0.587c-0.319,0.944-0.552,1.935-0.693,2.961C35.132,55.814,34.927,56,34.678,56H29  c-2.643,0-2.646,4,0,4h5.724c0.245,0,0.447,0.179,0.486,0.421c0.161,0.998,0.415,1.964,0.763,2.886c0.086,0.228,0,0.482-0.211,0.604  l-4.948,2.857c-2.289,1.321-0.291,4.787,2,3.464l4.958-2.863c0.211-0.122,0.475-0.069,0.63,0.12C41.152,70.848,45.32,73,50,73  s8.848-2.152,11.598-5.511c0.155-0.189,0.418-0.242,0.63-0.12l4.958,2.863c2.289,1.321,4.291-2.141,2-3.464l-4.948-2.857  c-0.211-0.122-0.298-0.376-0.211-0.604c0.347-0.922,0.602-1.888,0.763-2.886C64.828,60.179,65.031,60,65.276,60H71  C73.643,60,73.646,56,71,56z M44,66c-1.657,0-3-1.343-3-3s1.343-3,3-3s3,1.343,3,3S45.657,66,44,66z M44,56c-1.657,0-3-1.343-3-3  s1.343-3,3-3s3,1.343,3,3S45.657,56,44,56z M56,66c-1.657,0-3-1.343-3-3s1.343-3,3-3s3,1.343,3,3S57.657,66,56,66z M56,56  c-1.657,0-3-1.343-3-3s1.343-3,3-3s3,1.343,3,3S57.657,56,56,56z"></path>\n</svg>'}),ue=new x.LabIcon({name:"xircuits:lockIcon",svgstr:'\n<svg viewBox="0 0 512 512"  xmlns="http://www.w3.org/2000/svg"> \n    <g class="jp-icon3" fill="#616161">\n        <path d="m426.67 426.67v-213.34c0-23.465-19.199-42.668-42.668-42.668l-256 0.003907c-23.465 0-42.668 19.199-42.668 42.668v213.33c0 23.465 19.199 42.668 42.668 42.668h256c23.465-0.003907 42.668-19.203 42.668-42.668zm-128-106.67c0 23.465-19.199 42.668-42.668 42.668-23.465 0-42.668-19.199-42.668-42.668 0-23.465 19.199-42.668 42.668-42.668 23.465 0 42.668 19.203 42.668 42.668z"/>\n        <path transform="scale(21.333)" d="m17 12v-5.0001c0-2.8-2.2-5.0001-5.0001-5.0001-2.8 1.83e-4 -5.0001 2.2002-5.0001 5.0001v5.0001" fill="none" stroke="#616161" stroke-miterlimit="10" stroke-width="2"/>\n    </g>\n</svg>\n'}),ge=new x.LabIcon({name:"xircuits:breakpointIcon",svgstr:'<svg height=\'100px\' width=\'100px\' class="jp-icon3" fill="#616161" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" \n     version="1.1" x="0px" y="0px" viewBox="0 0 99 100" enable-background="new 0 0 99 100" xml:space="preserve">\n    <circle class="jp-icon3" stroke="#000000" stroke-miterlimit="10" cx="50.5" cy="50" r="30.167"></circle>\n    <circle class="jp-icon3" fill="#616161" stroke="#000000" stroke-miterlimit="10" cx="50.573" cy="50" r="27.973"></circle>\n</svg>'}),pe=new x.LabIcon({name:"xircuits:nextIcon",svgstr:'<svg stroke="black" stroke-width="5" class="jp-icon3" fill="#616161" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="17 9 50 70" enable-background="new 0 0 50 50" xml:space="preserve">\n    <polygon points="47.003,25 44.003,28.006 58.001,42 22,42 22,46 57.996,46 44,59.996 47,62.996 66.005,44.002 "></polygon>\n</svg>'}),me=new x.LabIcon({name:"xircuits:revertIcon",svgstr:'<?xml version="1.0" encoding="UTF-8"?>\n<svg class="jp-icon3" fill="#616161" version="1.1" viewBox="0 -55 1350 1350" xmlns="http://www.w3.org/2000/svg">\n <path d="m610.36 114.64c19.523 19.527 19.523 51.184 0 70.711l-64.645 64.645h79.289c232.61 0 425 192.39 425 425s-192.39 425-425 425-425-192.39-425-425c0-27.613 22.387-50 50-50s50 22.387 50 50c0 177.39 147.61 325 325 325s325-147.61 325-325-147.61-325-325-325h-79.289l64.645 64.645c19.523 19.527 19.523 51.184 0 70.711-19.527 19.523-51.184 19.523-70.711 0l-150-150c-19.527-19.527-19.527-51.184 0-70.711l150-150c19.527-19.527 51.184-19.527 70.711 0z"/>\n</svg>\n'}),he=new x.LabIcon({name:"xircuits:componentLibIcon",svgstr:'<svg class="jp-icon3"  fill="#616161" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="-50px" y="0px" \n     viewBox="15 0 70 100" enable-background="new 0 0 100 100" xml:space="preserve">\n    <g class="jp-icon3" fill="#616161" >\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M80,70H20V33h9v-7h16v7h12v-7h16v7h7V70z"></path>\n    </g>\n</svg>'});class be extends J.ABCWidgetFactory{constructor(e){super(e),this.app=e.app,this.shell=e.shell,this.commands=e.commands,this.serviceManager=e.serviceManager,this.saveXircuitSignal=new G.Signal(this),this.compileXircuitSignal=new G.Signal(this),this.runXircuitSignal=new G.Signal(this),this.runTypeXircuitSignal=new G.Signal(this),this.debugXircuitSignal=new G.Signal(this),this.lockNodeSignal=new G.Signal(this),this.breakpointXircuitSignal=new G.Signal(this),this.currentNodeSignal=new G.Signal(this),this.testXircuitSignal=new G.Signal(this),this.continueDebugSignal=new G.Signal(this),this.nextNodeDebugSignal=new G.Signal(this),this.stepOverDebugSignal=new G.Signal(this),this.terminateDebugSignal=new G.Signal(this),this.stepInDebugSignal=new G.Signal(this),this.stepOutDebugSignal=new G.Signal(this),this.evaluateDebugSignal=new G.Signal(this),this.debugModeSignal=new G.Signal(this)}createNewWidget(e){const t={app:this.app,shell:this.shell,commands:this.commands,context:e,serviceManager:this.serviceManager,saveXircuitSignal:this.saveXircuitSignal,compileXircuitSignal:this.compileXircuitSignal,runXircuitSignal:this.runXircuitSignal,runTypeXircuitSignal:this.runTypeXircuitSignal,debugXircuitSignal:this.debugXircuitSignal,lockNodeSignal:this.lockNodeSignal,breakpointXircuitSignal:this.breakpointXircuitSignal,currentNodeSignal:this.currentNodeSignal,testXircuitSignal:this.testXircuitSignal,continueDebugSignal:this.continueDebugSignal,nextNodeDebugSignal:this.nextNodeDebugSignal,stepOverDebugSignal:this.stepOverDebugSignal,terminateDebugSignal:this.terminateDebugSignal,stepInDebugSignal:this.stepInDebugSignal,stepOutDebugSignal:this.stepOutDebugSignal,evaluateDebugSignal:this.evaluateDebugSignal,debugModeSignal:this.debugModeSignal},n=new se(t),o=new J.DocumentWidget({content:n,context:e});o.addClass("xircuits-editor"),o.title.icon=ce;let i=new m.ToolbarButton({icon:x.saveIcon,tooltip:"Save Xircuits",onClick:()=>{this.commands.execute($.saveXircuit)}}),a=new m.ToolbarButton({icon:x.refreshIcon,tooltip:"Reload Xircuits from Disk",onClick:()=>{this.commands.execute($.reloadDocManager)}}),r=new m.ToolbarButton({icon:me,tooltip:"Revert Xircuits to Checkpoint",onClick:()=>{this.commands.execute($.revertDocManager)}}),s=new m.ToolbarButton({icon:x.checkIcon,tooltip:"Compile Xircuits",onClick:()=>{this.commands.execute($.compileXircuit)}}),l=new m.ToolbarButton({icon:x.runIcon,tooltip:"Run Xircuits",onClick:()=>{this.commands.execute($.runXircuit)}}),c=new m.ToolbarButton({icon:x.bugIcon,tooltip:"Open Xircuits Debugger and enable Image Viewer",onClick:()=>{this.commands.execute($.debugXircuit)}}),d=new m.ToolbarButton({icon:x.listIcon,tooltip:"Open log",onClick:()=>{this.commands.execute(S.openLog)}}),u=new m.ToolbarButton({icon:ue,tooltip:"Lock all non-general nodes connected from start node",onClick:()=>{this.commands.execute($.lockXircuit)}}),g=new m.ToolbarButton({icon:x.editIcon,tooltip:"For testing purpose",onClick:()=>{this.commands.execute($.testXircuit)}});return o.toolbar.insertItem(0,"xircuits-add-save",i),o.toolbar.insertItem(1,"xircuits-add-reload",a),o.toolbar.insertItem(2,"xircuits-add-revert",r),o.toolbar.insertItem(3,"xircuits-add-compile",s),o.toolbar.insertItem(4,"xircuits-add-run",l),o.toolbar.insertItem(5,"xircuits-add-debug",c),o.toolbar.insertItem(6,"xircuits-add-lock",u),o.toolbar.insertItem(7,"xircuits-add-log",d),o.toolbar.insertItem(8,"xircuits-add-test",g),o.toolbar.insertItem(9,"xircuits-run-type",new le(this)),o}}const xe=c().div`
	color: black;
	font-family: Helvetica, Arial;
	padding: 7px;
	width: auto;
	margin: 7px;
	border: solid 1px ${e=>e.color};
	border-radius: 5px;
	margin-bottom: 2px;
	cursor: pointer;
`;class fe extends o.Component{render(){return o.createElement(xe,{color:this.props.color||"white",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("storm-diagram-node",JSON.stringify(this.props.model)),this.forceUpdate()},onClick:e=>{if(e.ctrlKey||e.metaKey){const{commands:e}=this.props.app;e.execute("docmanager:open",{path:this.props.path})}this.forceUpdate()},onDoubleClick:e=>{if(""!=this.props.path){const{commands:e}=this.props.app;e.execute("docmanager:open",{path:this.props.path})}this.forceUpdate()},className:"tray-item"},this.props.name)}}const ve=c().div`
	min-width: 150px;
	background: rgb(255, 255, 255);
	flex-grow: 1;
	width: 150px;
	flex-shrink: 1;
	max-height: auto;
	overflow-y: auto;
`;class Se extends o.Component{render(){return o.createElement(ve,null,this.props.children)}}var we=n(76435);const ye=c().div`
  flex-grow: 1;
  display: flex;
  flex-wrap: wrap;
  min-height: 100%;
  background-color: black;
  height: 100%;
  overflow-y: auto;
`,Ee=c().div`
    display: flex;
    flex-grow: 1;
    flex-wrap: wrap;
    max-height: auto;
    'border-top': '4px solid #dfe2e5'
`;function ke(e){const[t,n]=i().useState([]),[a,r]=i().useState([]),[s,l]=(0,o.useState)(""),[c,d]=(0,o.useState)(!1),u=async()=>{const t=await N(e.lab.serviceManager),o=await async function(e){let t=e.map((e=>e.category)),n=Array.from(new Set(t)),o=[],i=[],a=[];for(let e=0;e<n.length;e++)"ADVANCED"==n[e]||"GENERAL"==n[e]?o.push(n[e]):i.push(n[e]);if(0!=o.length){o=o.sort(((e,t)=>e<t?1:e>t?-1:0)),n=[...o,...i];for(let e=0;e<n.length;e++)a.push({task:n[e],id:e+1})}return a}(t);t.length>0&&(n([]),r([])),n(t),r(o)};return(0,o.useEffect)((()=>{c||(u(),d(!0))}),[a,t]),(0,o.useEffect)((()=>{const e=setInterval((()=>{u()}),6e5);return()=>clearInterval(e)}),[a,t]),i().createElement(ye,null,i().createElement(Ee,null,i().createElement(Se,null,i().createElement("div",null,i().createElement("div",{className:"search-input"},i().createElement("input",{type:"text",name:"",value:s,placeholder:"SEARCH",className:"search-input__text-input",style:{width:"75%"},onChange:e=>{l(""),l(e.target.value)}}),i().createElement("a",{onClick:function(){l(""),l(s)},className:"search-input__button"},i().createElement("i",{className:"fa fa-search "})),i().createElement("a",{onClick:function(){u()},className:"search-input__button"},i().createElement("i",{className:"fa fa-refresh "}))),i().createElement(we.Accordion,{allowZeroExpanded:!0},a.filter((e=>{if(""==s)return e})).map(((n,o)=>i().createElement(we.AccordionItem,{key:`index-1-${n.task.toString()}`},i().createElement(we.AccordionItemHeading,null,i().createElement(we.AccordionItemButton,null,n.task)),i().createElement(we.AccordionItemPanel,null,t.filter((e=>{if(""==s)return e})).map(((t,o)=>{if(t.category.toString().toUpperCase()==n.task.toString())return i().createElement("div",{key:`index-1-${o}`},i().createElement(fe,{model:{type:t.type,name:t.task},name:t.task,color:t.color,app:e.lab,path:t.file_path}))}))))))),t.filter((e=>{if(""!=s&&e.task.toLowerCase().includes(s.toLowerCase()))return e})).map(((t,n)=>i().createElement("div",{key:`index-3-${n}`},i().createElement(fe,{model:{type:t.type,name:t.task},name:t.task,color:t.color,app:e.lab,path:t.file_path}))))))))}var Oe=n(96468),Ce=n(34456),_e=n(31748);const Ne=({xircuitFactory:e,currentNode:t})=>{const[n,a]=(0,o.useState)(""),[r,s]=(0,o.useState)(""),[l,c]=(0,o.useState)(""),[d,u]=(0,o.useState)([]),[g,p]=(0,o.useState)([]),m=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{m.current?(()=>{let e=void 0===t.item?"":t.item,n=void 0===t.item2?"":t.item2,o=e.getOptions().name,i=e.getOptions().id,r=e.getOptions().extras.type,l=[],d=[],g=[],m=n;if("string"!=typeof n&&(m=n.output),""!=m)if(m.includes("InArg ->")&&m.includes("OutArg ->")){let e=m.split("OutArg -> "),t=e[0].split("InArg -> ");for(let e=0;e<t[1].split("\t").length;e++)l.push(t[1].split("\t")[e]);for(let t=0;t<e[1].split("\t").length;t++)e[1].split("\t")[t].includes(": None")||l.push(e[1].split("\t")[t])}else if(m.includes("InArg ->")&&!m.includes("OutArg ->"))for(let e=0;e<m.split("InArg -> ")[1].split("\t").length;e++)l.push(m.split("InArg -> ")[1].split("\t")[e]);else if(!m.includes("InArg ->")&&m.includes("OutArg ->"))for(let e=0;e<m.split("OutArg -> ")[1].split("\t").length;e++)m.split("OutArg -> ")[1].split("\t")[e].includes(": None")||l.push(m.split("OutArg -> ")[1].split("\t")[e]);e.portsIn.forEach((e=>{"▶"!=e.getOptions().label&&d.push(e.getOptions().label)})),e.portsOut.forEach((e=>{"▶"!=e.getOptions().label&&g.push(e.getOptions().label)})),function(e,t,n,o,i){a(e),s(t),c(n),u(o),p(i)}(o,i,r,l,g)})():m.current=!0}),[t]),i().createElement("div",{style:{minHeight:"800px",height:"100%",width:"100%",minWidth:"150px",flexGrow:1,flexShrink:1,margin:"7px",padding:"7px",fontSize:"14px"}},i().createElement("p",null,i().createElement("b",null,"Selected Node")),i().createElement("p",null,i().createElement("b",null,"Name:")," ",n),i().createElement("p",null,i().createElement("b",null,"Id:")," ",r),i().createElement("p",null,i().createElement("b",null,"Type:")," ",l),i().createElement("p",null,i().createElement("b",null,"PortInLabel:")," ",d.map(((e,t)=>i().createElement("p",{key:t},e.split("\n").map(((e,t)=>i().createElement("p",{key:t},e))))))),i().createElement("p",null,i().createElement("b",null,"PortOutLabel:")," ",g.map(((e,t)=>i().createElement("p",{key:t},e)))))};class De extends m.ReactWidget{constructor(e){super(),this._xircuitFactory=e,this.addClass("jp-DebuggerWidget")}render(){return i().createElement(m.UseSignal,{signal:this._xircuitFactory.currentNodeSignal},((e,t)=>i().createElement(Ne,{xircuitFactory:this._xircuitFactory,currentNode:t})))}}const Pe="Xircuits-debugger:continue",Me="Xircuits-debugger:terminate",Ie="Xircuits-debugger:next";class Le extends P.Panel{constructor(e){super();const t=e.translator||Ce.nullTranslator,n=e.app,o=e.widgetFactory,i=t.load("jupyterlab");this.id="jp-debugger-sidebar",this.addClass("jp-DebuggerSidebar"),this._body=new P.SplitPanel,this._body.orientation="vertical",this.addWidget(this._body);const a=new De(o),r=new Xe(t),s=new Te;let l,c;o.debugModeSignal.connect(((e,t)=>{l=t.debugMode,c=t.inDebugMode,n.commands.notifyCommandChanged()})),s.toolbar.addItem("xircuits-debugger-continue",new m.CommandToolbarButton({commands:n.commands,id:Pe})),s.toolbar.addItem("xircuits-debugger-next",new m.CommandToolbarButton({commands:n.commands,id:$.nextNode})),s.toolbar.addItem("xircuits-debugger-step-over",new m.CommandToolbarButton({commands:n.commands,id:Ie})),s.toolbar.addItem("xircuits-debugger-breakpoint",new m.CommandToolbarButton({commands:n.commands,id:$.breakpointXircuit})),s.toolbar.addItem("xircuits-debugger-terminate",new m.CommandToolbarButton({commands:n.commands,id:Me})),s.toolbar.addItem("xircuits-debugger-step-in",new m.CommandToolbarButton({commands:n.commands,id:"Xircuits-debugger:step-in"})),s.toolbar.addItem("xircuits-debugger-step-out",new m.CommandToolbarButton({commands:n.commands,id:"Xircuits-debugger:step-out"})),s.toolbar.addItem("xircuits-debugger-evaluate-code",new m.CommandToolbarButton({commands:n.commands,id:"Xircuits-debugger:evaluate-code"})),n.commands.addCommand(Pe,{caption:i.__("Continue"),icon:_e.Debugger.Icons.continueIcon,isEnabled:()=>null!=l&&l,execute:e=>{o.continueDebugSignal.emit(e)}}),n.commands.addCommand($.nextNode,{caption:i.__("Next Node"),icon:pe,isEnabled:()=>null!=c&&c,execute:e=>{o.nextNodeDebugSignal.emit(e)}}),n.commands.addCommand(Ie,{caption:i.__("Step Over"),icon:_e.Debugger.Icons.stepOverIcon,isEnabled:()=>null!=c&&c,execute:e=>{o.stepOverDebugSignal.emit(e)}}),n.commands.addCommand($.breakpointXircuit,{caption:i.__("Toggle Breakpoint"),icon:ge,isEnabled:()=>null!=l&&l,execute:e=>{o.breakpointXircuitSignal.emit(e)}}),n.commands.addCommand(Me,{caption:i.__("Terminate"),icon:_e.Debugger.Icons.terminateIcon,isEnabled:()=>null!=l&&l,execute:e=>{o.terminateDebugSignal.emit(e)}}),this.addWidget(r),this.addWidget(s),this.addWidget(a),this.addClass("jp-DebuggerBreakpoints")}addItem(e){this._body.addWidget(e)}insertItem(e,t){this._body.insertWidget(e,t)}get items(){return this._body.widgets}dispose(){this.isDisposed||super.dispose()}}class Xe extends P.Widget{constructor(e){super({node:document.createElement("div")}),this.node.classList.add("jp-stack-panel-header");const t=(e=e||Ce.nullTranslator).load("jupyterlab"),n=new P.Widget({node:document.createElement("h2")});n.node.textContent=t.__("Xircuits Debugger");const o=new P.PanelLayout;o.addWidget(n),this.layout=o}}class Te extends P.Widget{constructor(){super({node:document.createElement("div")}),this.toolbar=new m.Toolbar,this.node.classList.add("jp-debugger-toolbar-panel");const e=new P.PanelLayout;e.addWidget(this.toolbar),this.layout=e}}var Ae;!function(e){e.Sidebar=class extends Le{}}(Ae||(Ae={}));var We=n(74130);class ze extends P.StackedPanel{constructor(e,t,n,o){super(),this._translator=o||Ce.nullTranslator,this._trans=this._translator.load("jupyterlab"),this._xircuitFactory=n,this.addClass("jp-RovaPanel"),this.id="xircuit-output-panel",this.title.label=this._trans.__("Xircuit Output"),this.title.closable=!0,this.title.icon=ce,this._sessionContext=new m.SessionContext({sessionManager:e.sessions,specsManager:e.kernelspecs,name:"Xircuit Output Process"}),this._outputareamodel=new We.OutputAreaModel,this._outputarea=new We.SimplifiedOutputArea({model:this._outputareamodel,rendermime:t}),this.addWidget(this._outputarea),this._sessionContext.initialize().then((async e=>{e&&(await m.sessionContextDialogs.selectKernel(this._sessionContext),this._sessionContext.hasNoKernel&&super.dispose())})).catch((e=>{console.error(`Failed to initialize the session in Xircuit Output.\n${e}`)}))}get session(){return this._sessionContext}dispose(){this._sessionContext.sessionManager.shutdown(this._sessionContext.session.id),this._sessionContext.dispose(),this._xircuitFactory.terminateDebugSignal.emit(this),this._sessionContext.sessionManager.refreshRunning(),super.dispose()}execute(e,t){We.SimplifiedOutputArea.execute(e,this._outputarea,this._sessionContext).then((e=>{if(this._outputarea.model.toJSON().length>0)for(let e=0;e<this._outputarea.model.toJSON().length;e++){if("error"==this._outputarea.model.toJSON()[e].output_type){let n=this._outputarea.model.toJSON()[e].ename,o=this._outputarea.model.toJSON()[e].evalue,i=this._outputarea.model.toJSON()[e].traceback;if(o.includes("File")&&o.includes("not found"))return alert(n+": "+o+" Please compile first!"),t.error(n+": "+o),void console.log(o+" Please compile first!");for(let e of i)t.error(e);return}let n=this._outputarea.model.toJSON()[e].text;for(let e=0;e<n.split("\n").length;e++)""!=n.split("\n")[e].trim()&&t.info(n.split("\n")[e])}})).catch((e=>console.error(e)))}onCloseRequest(e){super.onCloseRequest(e),this.dispose()}}const Fe="Xircuits editor",Be=new f.Token("xircuitsDocTracker"),Re=[{id:"xircuits",autoStart:!0,requires:[V.ILauncher,r.IFileBrowserFactory,a.ILayoutRestorer,w.IRenderMimeRegistry,Oe.IDocumentManager,Ce.ITranslator],provides:Be,activate:async(e,t,n,o,a,r,s)=>{console.log("Xircuits is activated!");const l=new be({name:Fe,fileTypes:["xircuits"],defaultFor:["xircuits"],app:e,shell:e.shell,commands:e.commands,serviceManager:e.serviceManager});e.docRegistry.addFileType({name:"xircuits",displayName:"Xircuits",extensions:[".xircuits"],icon:ce}),e.docRegistry.addWidgetFactory(l);const c=new m.WidgetTracker({namespace:"Xircuits Tracker"});l.widgetCreated.connect(((e,t)=>{c.add(t),t.context.pathChanged.connect((()=>{c.save(t)}))})),o.restore(c,{command:$.openDocManager,args:e=>({path:e.context.path,factory:Fe}),name:e=>e.context.path});const d=e.shell.widgets("top");let u=d.next();for(;void 0!==u;){if("jp-MainLogo"===u.id){ce.element({container:u.node,justify:"center",height:"auto",width:"25px"});break}u=d.next()}!function(e){let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("link"),o=document.getElementById("dynamic-favicon");n.id="dynamic-favicon",n.rel="icon",n.type="image/x-icon",n.href="https://raw.githubusercontent.com/XpressAI/xircuits/master/style/icons/xpress-logo.ico",o&&t.removeChild(o),t.appendChild(n)}();const p=m.ReactWidget.create(i().createElement(ke,{lab:e}));p.id="xircuits-component-sidebar",p.title.icon=he,p.title.caption="Xircuits Component Library",o.add(p,p.id),e.shell.add(p,"left");const h=new Ae.Sidebar({app:e,translator:s,widgetFactory:l});let f;h.id="xircuits-debugger-sidebar",h.title.icon=de,h.title.caption="Xircuits Debugger",o.add(h,h.id),e.shell.add(h,"right",{rank:1001}),function(e,t,n){const o=n.load("jupyterlab"),{commands:i,shell:a}=e;i.addCommand($.undo,{execute:()=>{var e;(null===(e=t.currentWidget)||void 0===e?void 0:e.content).context.model.sharedModel.undo()},label:o.__("Undo"),icon:x.undoIcon,isEnabled:()=>{var e;const n=(null===(e=t.currentWidget)||void 0===e?void 0:e.content).context.model.sharedModel.canUndo();return null!=n&&n}}),i.addCommand($.redo,{execute:()=>{var e;(null===(e=t.currentWidget)||void 0===e?void 0:e.content).context.model.sharedModel.redo()},label:o.__("Redo"),icon:x.redoIcon,isEnabled:()=>{var e;const n=(null===(e=t.currentWidget)||void 0===e?void 0:e.content).context.model.sharedModel.canRedo();return null!=n&&n}}),i.addCommand($.cutNode,{execute:function(){var e;const n=null===(e=t.currentWidget)||void 0===e?void 0:e.content;if(n){const e=n.xircuitsApp.getDiagramEngine(),t=n.xircuitsApp.getDiagramEngine().getModel().getSelectedEntities(),o=t.map((e=>e.clone().serialize()));t.forEach((e=>e.remove())),e.repaintCanvas(),localStorage.setItem("clipboard",JSON.stringify(o))}},label:o.__("Cut"),icon:x.cutIcon,isEnabled:()=>{var e;let n;return(null===(e=t.currentWidget)||void 0===e?void 0:e.content).xircuitsApp.getDiagramEngine().getModel().getSelectedEntities().length>0&&(n=!0),null!=n&&n}}),i.addCommand($.copyNode,{execute:function(){var e;const n=null===(e=t.currentWidget)||void 0===e?void 0:e.content;if(n){const e=n.xircuitsApp.getDiagramEngine().getModel().getSelectedEntities().map((e=>e.clone().serialize()));localStorage.setItem("clipboard",JSON.stringify(e))}},label:o.__("Copy"),icon:x.copyIcon,isEnabled:()=>{var e;let n;return(null===(e=t.currentWidget)||void 0===e?void 0:e.content).xircuitsApp.getDiagramEngine().getModel().getSelectedEntities().length>0&&(n=!0),null!=n&&n}}),i.addCommand($.pasteNode,{execute:function(){var e;const n=null===(e=t.currentWidget)||void 0===e?void 0:e.content;if(n){const e=n.xircuitsApp.getDiagramEngine(),t=n.xircuitsApp.getDiagramEngine().getModel(),o=JSON.parse(localStorage.getItem("clipboard"));if(!o)return;t.clearSelection();const i=o.map((n=>{const o=t.getActiveNodeLayer().getChildModelFactoryBank(e).getFactory(n.type).generateModel({initialConfig:n});return o.deserialize({engine:e,data:n,registerModel:()=>{},getModel:function(e){throw new Error("Function not implemented.")}}),o}));i.forEach((e=>{const n=e.getX(),o=e.getY();e.setPosition(n+10,o+10),t.addNode(e),"default"==e.getOptions().type&&t.removeNode(e),e.setSelected(!0)})),localStorage.setItem("clipboard",JSON.stringify(i.map((e=>e.clone().serialize())))),n.xircuitsApp.getDiagramEngine().repaintCanvas()}},label:o.__("Paste"),icon:x.pasteIcon,isEnabled:()=>{let e;return JSON.parse(localStorage.getItem("clipboard"))&&(e=!0),null!=e&&e}}),i.addCommand($.editNode,{execute:function(){var e;const n=null===(e=t.currentWidget)||void 0===e?void 0:e.content;if(n){const e=n.xircuitsApp.getDiagramEngine().getModel().getSelectedEntities();K.forEach(e,(e=>{let t=null,o=n.xircuitsApp.getDiagramEngine().getModel().layers[0].models,i=e.getPorts()["out-0"].getOptions().label,a=window.prompt("Enter New Value (Without Quotes):",i);if(null==a||""==a||a==i)return;t=new b({name:e.name,color:e.color,extras:{type:e.extras.type}}),t.addOutPortEnhance(a,"out-0");let r=e.getPosition();t.setPosition(r),n.xircuitsApp.getDiagramEngine().getModel().addNode(t);for(let i in o){let a=o[i];if(a.sourcePort&&a.targetPort){let o=new g.DefaultLinkModel,i=t.getPorts()["out-0"];o.setSourcePort(i),a.sourcePort.getParent().getID()==e.getOptions().id&&o.setTargetPort(a.targetPort),n.xircuitsApp.getDiagramEngine().getModel().addLink(o)}}e.remove()}))}},label:o.__("Edit"),isEnabled:()=>{var e;const n=(null===(e=t.currentWidget)||void 0===e?void 0:e.content).xircuitsApp.getDiagramEngine().getModel().getSelectedEntities();let o;return K.forEach(n,(e=>{e.getOptions().name.startsWith("Literal")&&(o=!0)})),null!=o&&o}}),i.addCommand($.deleteNode,{execute:function(){var e;const n=null===(e=t.currentWidget)||void 0===e?void 0:e.content;if(n){const e=n.xircuitsApp.getDiagramEngine().getModel().getSelectedEntities();K.forEach(e,(e=>{if("undefined"!==e.getOptions().name){let t=e.getOptions().name;const n=`${t} node cannot be deleted!`;"Start"!==t&&"Finish"!==t?e.isLocked()?(0,m.showDialog)({title:"Locked Node",body:n,buttons:[m.Dialog.warnButton({label:"OK"})]}):e.remove():(0,m.showDialog)({title:"Undeletable Node",body:n,buttons:[m.Dialog.warnButton({label:"OK"})]})}})),n.xircuitsApp.getDiagramEngine().repaintCanvas()}},label:"Delete",isEnabled:()=>{var e;let n;return(null===(e=t.currentWidget)||void 0===e?void 0:e.content).xircuitsApp.getDiagramEngine().getModel().getSelectedEntities().length>0&&(n=!0),null!=n&&n}})}(e,c,s),e.commands.addCommand($.openDebugger,{execute:()=>{h.isHidden&&e.shell.activateById(h.id)}}),e.commands.addCommand($.createNewXircuit,{label:e=>e.isLauncher?"Xircuits File":"Create New Xircuits",icon:ce,caption:"Create a new xircuits file",execute:()=>{e.commands.execute($.newDocManager,{path:n.defaultBrowser.model.path,type:"file",ext:".xircuits"}).then((async t=>{(await e.commands.execute($.openDocManager,{path:t.path,factory:Fe})).context.ready.then((()=>{e.commands.execute($.saveXircuit,{path:t.path})}))}))}}),e.commands.addCommand($.createArbitraryFile,{execute:async t=>{const n=c.currentWidget.context.path,o=n,i=void 0===typeof t.pythonCode?"":t.pythonCode,a=void 0!==typeof t.showOutput&&t.showOutput,s=await async function(e,t){const n={currentPath:e.split(".xircuits")[0]+".py",compilePythonScript:t};try{return await _("file/generate",{body:JSON.stringify(n),method:"POST"})}catch(e){console.error(`Error on POST /xircuits/file/generate ${n}.\n${e}`)}}(o,i);if("completed"==s.message){const t=n.split(".xircuits")[0]+".py";await e.commands.execute($.openDocManager,{path:t}),r.closeFile(t),a&&alert(`${t} successfully compiled!`)}else alert("Failed to generate arbitrary file!")}}),window.addEventListener("beforeunload",(function(e){f.dispose()})),e.commands.addCommand($.executeToOutputPanel,{execute:async t=>{const n=new k(e),o=c.currentWidget.context.path.split(".xircuits")[0]+".py",i=void 0===t.runCommand?"":t.runCommand,r=void 0===t.debug_mode?"":t.debug_mode,d=void 0===t.runType?"":t.runType,u=void 0===t.addArgsSparkSubmit?"":t.addArgsSparkSubmit;f&&!f.isDisposed||await async function(){return f=new ze(e.serviceManager,a,l,s),e.shell.add(f,"main",{mode:"split-bottom"}),f}(),f.session.ready.then((async()=>{let e="%run "+o+i+r;if("spark-submit"==d){const t=await async function(e,t){const n={currentPath:e,addArgs:t};try{return await _("spark/submit",{body:JSON.stringify(n),method:"POST"})}catch(e){console.error(`Error on POST /xircuits/spark/submit ${n}.\n${e}`)}}(o,u),n=t.stderr,i=t.stdout;let a="";a=0!=i?i:n,e=`print("""${a}""")`}f.execute(e,n)}))}}),e.commands.addCommand($.saveXircuit,{label:"Save",icon:x.saveIcon,execute:e=>{l.saveXircuitSignal.emit(e)}}),e.commands.addCommand($.compileXircuit,{execute:e=>{l.compileXircuitSignal.emit(e)}}),e.commands.addCommand($.runXircuit,{label:"Run Xircuits",icon:x.runIcon,execute:e=>{l.runXircuitSignal.emit(e)}}),e.commands.addCommand($.debugXircuit,{execute:e=>{l.debugXircuitSignal.emit(e)}}),e.commands.addCommand($.lockXircuit,{execute:e=>{l.lockNodeSignal.emit(e)}}),e.commands.addCommand($.testXircuit,{execute:e=>{l.testXircuitSignal.emit(e)}}),t&&t.add({command:$.createNewXircuit,rank:1,args:{isLauncher:!0},category:"Other"})}},E]}}]);