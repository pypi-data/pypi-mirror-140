{"version":3,"sources":["inlineFormGroupViewTests.es6.js"],"names":[],"mappings":"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","file":"inlineFormGroupViewTests.js","sourcesContent":["suite('rb/admin/views/InlineFormGroupView', function() {\n    const inlineTemplate = _.template(dedent`\n        <div class=\"rb-c-admin-form-inline <%- classes || '' %>\">\n         <h3 class=\"rb-c-admin-form-inline__title\">\n          <span class=\"rb-c-admin-form-inline__title-prefix\"></span>\n          <span class=\"rb-c-admin-form-inline__title-object\"></span>\n          <span class=\"rb-c-admin-form-inline__title-index\"></span>\n          <span class=\"rb-c-admin-form-inline__actions\">\n           <span class=\"rb-c-admin-form-inline__delete-action\"></span>\n          </span>\n         </h3>\n         <fieldset>\n          <div>\n           <label for=\"myprefix-<%- index %>-foo\"></label>\n           <input id=\"myprefix-<%- index %>-foo\"\n                  name=\"myprefix-<%- index %>-foo\">\n          </div>\n          <div>\n           <label for=\"myprefix-<%- index %>-bar\"></label>\n           <input id=\"myprefix-<%- index %>-bar\"\n                  name=\"myprefix-<%- index %>-bar\">\n          </div>\n         </fieldset>\n        </div>\n    `);\n\n    const template = _.template(dedent`\n        <div class=\"rb-c-admin-form-inline-group\">\n         <h2 class=\"rb-c-admin-form-inline-group__title\"></h2>\n         <div class=\"rb-c-admin-form-inline-group__inlines\">\n          <input type=\"hidden\"\n                 id=\"id_myprefix-TOTAL_FORMS\"\n                 name=\"myprefix-TOTAL_FORMS\"\n                 value=\"<%- totalForms %>\">\n          <input type=\"hidden\"\n                 id=\"id_myprefix-INITIAL_FORMS\"\n                 name=\"myprefix-INITIAL_FORMS\"\n                 value=\"<%- initialForms %>\">\n          <input type=\"hidden\"\n                 id=\"id_myprefix-MIN_NUM_FORMS\"\n                 name=\"myprefix-MIN_NUM_FORMS\"\n                 value=\"<%- minNumForms %>\">\n          <input type=\"hidden\"\n                 id=\"id_myprefix-MAX_NUM_FORMS\"\n                 name=\"myprefix-MAX_NUM_FORMS\"\n                 value=\"<%- maxNumForms %>\">\n\n          <% for (let i = 0; i < numInlines; i++) { %>\n           <%= inlineTemplate({\n               classes: '',\n               index: i\n           }) %>\n          <% } %>\n          <%= inlineTemplate({\n              classes: '-is-template',\n              index: '__prefix__'\n          }) %>\n         </div>\n         <div class=\"rb-c-admin-form-inline-group__actions\">\n          <a href=\"#\" class=\"rb-c-admin-form-inline-group__add-action\"></a>\n         </div>\n        </div>\n    `);\n\n    let $el;\n    let model;\n    let view;\n\n    function buildView(options) {\n        $el =\n            $(template(_.extend({\n                initialForms: 0,\n                inlineTemplate: inlineTemplate,\n                maxNumForms: '',\n                minNumForms: 0,\n                numInlines: 0,\n                totalForms: 0,\n            }, options)))\n            .appendTo($testsScratch);\n\n        view = new RB.Admin.InlineFormGroupView({\n            el: $el,\n            model: model,\n        });\n        view.render();\n    }\n\n    beforeEach(function() {\n        model = new RB.Admin.InlineFormGroup({\n            prefix: 'myprefix',\n        });\n    });\n\n    describe('State', function() {\n        it('Populated on render', function() {\n            buildView({\n                numInlines: 2,\n                initialForms: 2,\n                minNumForms: 1,\n                maxNumForms: 5,\n                totalForms: 2,\n            });\n\n            expect($el.find('.rb-c-admin-form-inline').length).toBe(2);\n            expect(view._$inlineTemplate.length).toBe(1);\n            expect(view._$inlineTemplate.hasClass('-is-template')).toBeFalse();\n\n            expect(model.get('initialInlines')).toBe(2);\n            expect(model.get('maxInlines')).toBe(5);\n            expect(model.get('minInlines')).toBe(1);\n\n            expect(model.inlines.length).toBe(2);\n            expect(view._inlineViews.length).toBe(2);\n\n            let inline = model.inlines.at(0);\n            expect(inline.get('index')).toBe(0);\n            expect(inline.get('isInitial')).toBeTrue();\n            expect(view._inlineViews[0].model).toBe(inline);\n\n            inline = model.inlines.at(1);\n            expect(inline.get('index')).toBe(1);\n            expect(inline.get('isInitial')).toBeTrue();\n            expect(view._inlineViews[1].model).toBe(inline);\n        });\n\n        it('Updated when inlines added', function() {\n            buildView({\n                numInlines: 1,\n                initialForms: 1,\n                totalForms: 1,\n            });\n\n            const $totalForms = $el.find('#id_myprefix-TOTAL_FORMS');\n            const $addButton =\n                $el.find('.rb-c-admin-form-inline-group__add-action');\n\n            expect($el.find('.rb-c-admin-form-inline').length).toBe(1);\n            expect($totalForms.val()).toBe('1');\n\n            $addButton.click();\n            expect($el.find('.rb-c-admin-form-inline').length).toBe(2);\n            expect($totalForms.val()).toBe('2');\n\n            $addButton.click();\n            expect($el.find('.rb-c-admin-form-inline').length).toBe(3);\n            expect($totalForms.val()).toBe('3');\n        });\n\n        it('Updated when inlines added', function() {\n            buildView({\n                numInlines: 2,\n                initialForms: 2,\n                totalForms: 2,\n            });\n\n            const $totalForms = $el.find('#id_myprefix-TOTAL_FORMS');\n\n            expect(model.inlines.length).toBe(2);\n            expect($totalForms.val()).toBe('2');\n\n            model.inlines.at(0).destroy();\n\n            const $inlines = $el.find('.rb-c-admin-form-inline');\n            expect($inlines.length).toBe(1);\n            expect(model.inlines.length).toBe(1);\n            expect($totalForms.val()).toBe('1');\n            expect($inlines[0].id).toBe('myprefix-0');\n        });\n    });\n\n    describe('UI', function() {\n        describe('Add Button', function() {\n            let $addButton;\n\n            beforeEach(function() {\n                buildView({\n                    numInlines: 1,\n                    initialForms: 1,\n                    minNumForms: 0,\n                    maxNumForms: 3,\n                    totalForms: 1,\n                });\n\n                $addButton =\n                    $el.find('.rb-c-admin-form-inline-group__add-action');\n                expect($addButton.length).toBe(1);\n            });\n\n            it('When under limit', function() {\n                expect($addButton.is(':visible')).toBeTrue();\n\n                view.addInlineForm();\n                expect($addButton.is(':visible')).toBeTrue();\n            });\n\n            it('When limit hit', function() {\n                expect($addButton.is(':visible')).toBeTrue();\n\n                view.addInlineForm();\n                view.addInlineForm();\n                expect($addButton.is(':visible')).toBeFalse();\n            });\n        });\n    });\n});\n"]}