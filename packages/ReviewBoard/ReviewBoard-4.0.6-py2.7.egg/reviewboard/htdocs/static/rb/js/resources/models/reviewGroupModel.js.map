{"version":3,"sources":["reviewGroupModel.es6.js"],"names":[],"mappings":"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","file":"reviewGroupModel.js","sourcesContent":["(function() {\n\n\n/**\n * A member of a review group.\n *\n * This is used to handle adding a user to a group or removing from a group.\n */\nconst GroupMember = RB.BaseResource.extend({\n    defaults() {\n        return _.defaults({\n            username: null,\n            added: false,\n            loaded: true\n        }, RB.BaseResource.prototype.defaults());\n    },\n\n    serializedAttrs: ['username'],\n\n    /**\n     * Return a URL for this resource.\n     *\n     * If this represents an added user, the URL will point to\n     * <groupname>/<username>/. Otherwise, it just points to <groupname>/.\n     *\n     * Returns:\n     *     string:\n     *     The URL to use when syncing the model.\n     */\n    url() {\n        let url = this.get('baseURL');\n\n        if (this.get('added')) {\n            url += this.get('username') + '/';\n        }\n\n        return url;\n    },\n\n    /**\n     * Return whether the group membership is \"new\".\n     *\n     * A non-added user is new, meaning the save operation will trigger\n     * a POST to add the user.\n     *\n     * Returns:\n     *     boolean:\n     *     Whether this member is newly-added to the group.\n     */\n    isNew() {\n        return !this.get('added');\n    },\n\n    /**\n     * Parse the result payload.\n     *\n     * We don't really care about the result, so we don't bother doing any\n     * work to parse.\n     */\n    parse() {}\n});\n\n\n/**\n * A review group.\n *\n * This provides some utility functions for working with an existing\n * review group.\n *\n * At the moment, this consists of marking a review group as\n * starred/unstarred.\n */\nRB.ReviewGroup = RB.BaseResource.extend({\n    defaults() {\n        return _.defaults({\n            name: null\n        }, RB.BaseResource.prototype.defaults());\n    },\n\n    rspNamespace: 'group',\n\n    /**\n     * Return the URL to the review group.\n     *\n     * If this is a new group, the URL will point to the base groups/ URL.\n     * Otherwise, it points to the URL for the group itself.\n     *\n     * Returns:\n     *     string:\n     *     The URL to use when syncing the model.\n     */\n    url() {\n        let url = SITE_ROOT + (this.get('localSitePrefix') || '') +\n                  'api/groups/';\n\n        if (!this.isNew()) {\n            url += this.get('name') + '/';\n        }\n\n        return url;\n    },\n\n    /**\n     * Mark a review group as starred or unstarred.\n     *\n     * Args:\n     *     starred (boolean):\n     *         Whether or not the group is starred.\n     *\n     *     options (object):\n     *         Additional options for the save operation, including callbacks.\n     *\n     *     context (object):\n     *         Context to bind when calling callbacks.\n     */\n    setStarred(starred, options, context) {\n        const watched = RB.UserSession.instance.watchedGroups;\n\n        if (starred) {\n            watched.addImmediately(this, options, context);\n        } else {\n            watched.removeImmediately(this, options, context);\n        }\n    },\n\n    /**\n     * Add a user to this group.\n     *\n     * Sends the request to the server to add the user, and notifies on\n     * succes or failure.\n     *\n     * Args:\n     *     username (string):\n     *         The username of the new user.\n     *\n     *     options (object):\n     *         Additional options for the save operation, including callbacks.\n     *\n     *     context (object):\n     *         Context to bind when calling callbacks.\n     */\n    addUser(username, options, context) {\n        const url = this.url() + 'users/';\n\n        if (url && !this.isNew()) {\n            const member = new GroupMember({\n                username: username,\n                baseURL: url\n            });\n\n            member.save(options, context);\n        } else if (options && _.isFunction(options.error)) {\n            options.error.call({\n                errorText: 'Unable to add to the group.'\n            });\n        }\n    },\n\n    /*\n     * Remove a user from this group.\n     *\n     * Sends the request to the server to remove the user, and notifies on\n     * succes or failure.\n     *\n     * Args:\n     *     username (string):\n     *         The username of the new user.\n     *\n     *     options (object):\n     *         Additional options for the save operation, including callbacks.\n     *\n     *     context (object):\n     *         Context to bind when calling callbacks.\n     */\n    removeUser(username, options, context) {\n        const url = this.url() + 'users/';\n\n        if (url && !this.isNew()) {\n            const member = new GroupMember({\n                username: username,\n                baseURL: url,\n                added: true\n            });\n\n            member.destroy(options, context);\n        } else if (options && _.isFunction(options.error)) {\n            options.error.call({\n                errorText: 'Unable to remove from the group.'\n            });\n        }\n    }\n});\n\n\n})();\n"]}