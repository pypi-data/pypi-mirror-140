{"version":3,"sources":["newsWidgetViewTests.es6.js"],"names":[],"mappings":"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","file":"newsWidgetViewTests.js","sourcesContent":["suite('rb/admin/views/NewsWidgetView', function() {\n    const template = dedent`\n        <div class=\"rb-c-admin-widget rb-c-news-admin-widget\">\n         <header class=\"rb-c-admin-widget__header\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </header>\n         <div class=\"rb-c-admin-widget__content\"></div>\n         <footer class=\"rb-c-admin-widget__footer\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </footer>\n        </div>\n    `;\n\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.Admin.NewsWidget({\n            newsURL: 'http://example.com/news/',\n        });\n\n        view = new RB.Admin.NewsWidgetView({\n            el: $(template),\n            model: model,\n        });\n\n        spyOn(model, 'loadNews');\n    });\n\n    describe('Rendering', function() {\n        describe('Actions', function() {\n            it('More News', function() {\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(1);\n\n                const $action = $actions.eq(0);\n                expect($action.hasClass('js-action-more-news')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/');\n            });\n\n            it('Subscribe', function() {\n                model.set('subscribeURL', 'http://example.com/news/subscribe/');\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(2);\n\n                const $action = $actions.eq(1);\n                expect($action.hasClass('js-action-subscribe')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/subscribe/');\n            });\n\n            describe('Reload', function() {\n                it('On loadingNews event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n\n                    model.trigger('loadingNews');\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n                });\n\n                it('On change:newsItems event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n\n                    view.setReloading(true);\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n\n                    model.set('newsItems', []);\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n                });\n            });\n        });\n\n        it('News items', function() {\n            view.render();\n\n            model.set('newsItems', [\n                {\n                    date: moment(Date.UTC(2019, 9, 21, 0, 26, 32)),\n                    title: 'Headline 6',\n                    url: 'http://example.com/news/post6',\n                },\n                {\n                    date: moment(Date.UTC(2019, 9, 1, 20, 29, 0)),\n                    title: 'Headline 5',\n                    url: 'http://example.com/news/post5',\n                },\n                {\n                    date: moment(Date.UTC(2019, 8, 27, 2, 29, 33)),\n                    title: 'Headline 4',\n                    url: 'http://example.com/news/post4',\n                },\n            ]);\n\n            const $items = view.$content.children();\n            expect($items.length).toBe(3);\n\n            let $item = $items.eq(0);\n            expect($item.attr('href')).toBe('http://example.com/news/post6');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date').text().strip()\n            ).toBe('Oct 20');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title').text().strip()\n            ).toBe('Headline 6');\n\n            $item = $items.eq(1);\n            expect($item.attr('href')).toBe('http://example.com/news/post5');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().strip()\n            ).toBe('Oct 01');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().strip()\n            ).toBe('Headline 5');\n\n            $item = $items.eq(2);\n            expect($item.attr('href')).toBe('http://example.com/news/post4');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().strip()\n            ).toBe('Sep 26');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().strip()\n            ).toBe('Headline 4');\n        });\n\n        it('Load errors', function() {\n            view.render();\n\n            model.set('newsItems', []);\n\n            const $els = view.$content.children();\n            expect($els.length).toBe(1);\n\n            const $error = $els.eq(0);\n            expect($error.hasClass('rb-c-admin-news-widget__error'))\n                .toBeTrue();\n            expect($error.html().strip()).toBe(\n                'There was an error loading the news. Please ' +\n                '<a href=\"http://example.com/news/\">visit the news page</a> ' +\n                'directly, or try again later.');\n        });\n    });\n});\n"]}