{"version":3,"sources":["baseResourceModel.es6.js"],"names":[],"mappings":"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","file":"baseResourceModel.js","sourcesContent":["/**\n * The base model for all API-backed resource models.\n *\n * This provides a common set of attributes and functionality for working\n * with Review Board's REST API. That includes fetching data for a known\n * resource, creating resources, saving, deleting, and navigating children\n * resources by way of a payload's list of links.\n *\n * Other resource models are expected to extend this. In particular, they\n * should generally be extending toJSON() and parse().\n */\nRB.BaseResource = Backbone.Model.extend({\n    /**\n     * Return default values for the model attributes.\n     *\n     * Returns:\n     *     object:\n     *     The attribute defaults.\n     */\n    defaults() {\n        return {\n            extraData: {},\n            links: null,\n            loaded: false,\n            parentObject: null\n        };\n    },\n\n    /** The key for the namespace for the object's payload in a response. */\n    rspNamespace: '',\n\n    /** The attribute used for the ID in the URL. */\n    urlIDAttr: 'id',\n\n    listKey() {\n        return this.rspNamespace + 's';\n    },\n\n    /** The list of fields to expand in resource payloads. */\n    expandedFields: [],\n\n    /**\n     * Extra query arguments for GET requests.\n     *\n     * This may also be a function that returns the extra query arguments.\n     *\n     * These values can be overridden by the caller when making a request.\n     * They function as defaults for the queries.\n     */\n    extraQueryArgs: {},\n\n    /** Whether or not extra data can be associated on the resource. */\n    supportsExtraData: false,\n\n    /**\n     * A map of attribute names to resulting JSON field names.\n     *\n     * This is used to auto-generate a JSON payload from attribute names\n     * in toJSON().\n     *\n     * It's also needed if using attribute names in any save({attrs: [...]})\n     * calls.\n     */\n    attrToJsonMap: {},\n\n    /** A list of attributes to serialize in toJSON(). */\n    serializedAttrs: [],\n\n    /** A list of attributes to deserialize in parseResourceData(). */\n    deserializedAttrs: [],\n\n    /** Special serializer functions called in toJSON(). */\n    serializers: {},\n\n    /** Special deserializer functions called in parseResourceData(). */\n    deserializers: {},\n\n    /**\n     * Initialize the model.\n     */\n    initialize() {\n        if (this.supportsExtraData) {\n            this._setupExtraData();\n        }\n    },\n\n    /**\n     * Return the URL for this resource's instance.\n     *\n     * If this resource is loaded and has a URL to itself, that URL will\n     * be returned. If not yet loaded, it'll try to get it from its parent\n     * object, if any.\n     *\n     * Returns:\n     *     string:\n     *     The URL to use when fetching the resource. If the URL cannot be\n     *     determined, this will return null.\n     */\n    url() {\n        let links = this.get('links');\n\n        if (links) {\n            return links.self.href;\n        }\n\n        const parentObject = this.get('parentObject');\n\n        if (parentObject) {\n            links = parentObject.get('links');\n\n            if (links) {\n                const key = _.result(this, 'listKey');\n                const link = links[key];\n\n                if (link) {\n                    const baseURL = link.href;\n\n                    return this.isNew()\n                           ? baseURL\n                           : (baseURL + this.get(this.urlIDAttr) + '/');\n                }\n            }\n        }\n\n        return null;\n    },\n\n    /**\n     * Call a function when the object is ready to use.\n     *\n     * An object is ready it has an ID and is loaded, or is a new resource.\n     *\n     * When the object is ready, options.ready() will be called. This may\n     * be called immediately, or after one or more round trips to the server.\n     *\n     * If we fail to load the resource, objects.error() will be called instead.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the fetch operation.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     *\n     * Option Args:\n     *     ready (function):\n     *         Callback function for when the object is ready to use.\n     *\n     *     error (function):\n     *         Callback function for when an error occurs.\n     */\n    ready(options={}, context=undefined) {\n        const success = _.isFunction(options.ready)\n                        ? _.bind(options.ready, context)\n                        : undefined;\n        const error = _.isFunction(options.error)\n                      ? _.bind(options.error, context)\n                      : undefined;\n\n        const parentObject = this.get('parentObject');\n\n        if (this.get('loaded')) {\n            // We already have data--just call the callbacks\n            if (success) {\n                success();\n            }\n        } else if (!this.isNew()) {\n            // Fetch data from the server\n            this.fetch({\n                data: options.data,\n                success: success,\n                error: error\n            });\n        } else if (parentObject) {\n            /*\n             * This is a new object, which means there's nothing to fetch from\n             * the server, but we still need to ensure that the parent is loaded\n             * in order for it to have valid links.\n             */\n            parentObject.ready({\n                ready: success,\n                error: error\n            });\n        } else if (success) {\n            // Fallback for dummy objects.\n            success();\n        }\n    },\n\n    /**\n     * Call a function when we know an object exists server-side.\n     *\n     * This works like ready() in that it's used to delay operating on the\n     * resource until we have a server-side representation. Unlike ready(),\n     * it will attempt to create it if it doesn't exist first.\n     *\n     * When the object has been created, or we know it already is,\n     * options.success() will be called.\n     *\n     * If we fail to create the object, options.error() will be called\n     * instead.\n     *\n     * Args:\n     *     options (object):\n     *         Object with success and error callbacks.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     */\n    ensureCreated(options={}, context=undefined) {\n        this.ready({\n            ready: () => {\n                if (!this.get('loaded')) {\n                    this.save({\n                        success: _.isFunction(options.success)\n                                 ? _.bind(options.success, context)\n                                 : undefined,\n                        error: _.isFunction(options.error)\n                               ? _.bind(options.error, context)\n                               : undefined\n                    });\n                } else if (_.isFunction(options.success)) {\n                    options.success.call(context);\n                }\n            }\n        });\n    },\n\n    /**\n     * Fetch the object's data from the server.\n     *\n     * An object must have an ID before it can be fetched. Otherwise,\n     * options.error() will be called.\n     *\n     * If this has a parent resource object, we'll ensure that's ready before\n     * fetching this resource.\n     *\n     * The resource must override the parse() function to determine how\n     * the returned resource data is parsed and what data is stored in\n     * this object.\n     *\n     * If we successfully fetch the resource, options.success() will be\n     * called.\n     *\n     * If we fail to fetch the resource, options.error() will be called.\n     *\n     * Args:\n     *     options (object):\n     *         Object with success and error callbacks.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     */\n    fetch(options={}, context=undefined) {\n        options = _.bindCallbacks(options, context);\n\n        if (this.isNew()) {\n            if (_.isFunction(options.error)) {\n                options.error.call(context,\n                    'fetch cannot be used on a resource without an ID');\n            }\n\n            return;\n        }\n\n        const parentObject = this.get('parentObject');\n\n        if (parentObject) {\n            parentObject.ready({\n                ready: () => Backbone.Model.prototype.fetch.call(this, options),\n                error: options.error\n            }, this);\n        } else {\n            Backbone.Model.prototype.fetch.call(this, options);\n        }\n    },\n\n    /**\n     * Save the object's data to the server.\n     *\n     * If the object has an ID already, it will be saved to its known\n     * URL using HTTP PUT. If it doesn't have an ID, it will be saved\n     * to its parent list resource using HTTP POST\n     *\n     * If this has a parent resource object, we'll ensure that's created\n     * before saving this resource.\n     *\n     * An object must either be loaded or have a parent resource linking to\n     * this object's list resource URL for an object to be saved.\n     *\n     * The resource must override the toJSON() function to determine what\n     * data is saved to the server.\n     *\n     * If we successfully save the resource, options.success() will be\n     * called, and the \"saved\" event will be triggered.\n     *\n     * If we fail to save the resource, options.error() will be called.\n     *\n     * Args:\n     *     options (object):\n     *         Object with success and error callbacks.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     */\n    save(options={}, context=undefined) {\n        this.trigger('saving', options);\n\n        this.ready({\n            ready: () => {\n                const parentObject = this.get('parentObject');\n\n                if (parentObject) {\n                    parentObject.ensureCreated({\n                        success: this._saveObject.bind(this, options, context),\n                        error: options.error\n                    }, this);\n                } else {\n                    this._saveObject(options, context);\n                }\n            },\n            error: _.isFunction(options.error)\n                   ? _.bind(options.error, context)\n                   : undefined\n        }, this);\n    },\n\n    /**\n     * Handle the actual saving of the object's state.\n     *\n     * This is called internally by save() once we've handled all the\n     * readiness and creation checks of this object and its parent.\n     *\n     * Args:\n     *     options (object):\n     *         Object with success and error callbacks.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     */\n    _saveObject(options, context) {\n        const url = _.result(this, 'url');\n        if (!url) {\n            if (_.isFunction(options.error)) {\n                options.error.call(context,\n                    'The object must either be loaded from the server or ' +\n                    'have a parent object before it can be saved');\n            }\n\n            return;\n        }\n\n        const saveOptions = _.defaults({\n            success: (...args) => {\n                if (_.isFunction(options.success)) {\n                    options.success.apply(context, args);\n                }\n\n                this.trigger('saved', options);\n            },\n            error: (...args) => {\n                if (_.isFunction(options.error)) {\n                    options.error.apply(context, args);\n                }\n\n                this.trigger('saveFailed', options);\n            }\n        }, options);\n\n        saveOptions.attrs = options.attrs || this.toJSON(options);\n\n        const files = [];\n        const readers = [];\n\n        if (!options.form) {\n            if (this.payloadFileKeys && window.File) {\n                /* See if there are files in the attributes we're using. */\n                this.payloadFileKeys.forEach(key => {\n                    const file = saveOptions.attrs[key];\n\n                    if (file) {\n                        files.push(file);\n                    }\n                });\n            }\n        }\n\n        if (files.length > 0) {\n            files.forEach(file => {\n                const reader = new FileReader();\n\n                readers.push(reader);\n                reader.onloadend = () => {\n                    if (readers.every(r => r.readyState === FileReader.DONE)) {\n                        this._saveWithFiles(files, readers, saveOptions);\n                    }\n                };\n                reader.readAsArrayBuffer(file);\n            });\n        } else {\n            Backbone.Model.prototype.save.call(this, {}, saveOptions);\n        }\n    },\n\n    /**\n     * Save the model with a file upload.\n     *\n     * When doing file uploads, we need to hand-structure a form-data payload\n     * to the server. It will contain the file contents and the attributes\n     * we're saving. We can then call the standard save function with this\n     * payload as our data.\n     *\n     * Args:\n     *     files (Array of object):\n     *         A list of files, with ``name`` and ``type`` keys.\n     *\n     *     fileReaders (Array of FileReader):\n     *         Readers corresponding to each item in ``files``.\n     *\n     *     options (object):\n     *         Options for the save operation.\n     *\n     * Option Args:\n     *     boundary (string):\n     *         Optional MIME multipart boundary.\n     *\n     *     attrs (object):\n     *         Additional key/value pairs to include in the payload data.\n     */\n    _saveWithFiles(files, fileReaders, options) {\n        const boundary = options.boundary ||\n                         ('-----multipartformboundary' + new Date().getTime());\n        const blob = [];\n\n        for (let [key, file, reader] of\n             _.zip(this.payloadFileKeys, files, fileReaders)) {\n            if (!file || !reader) {\n                continue;\n            }\n\n            blob.push('--' + boundary + '\\r\\n');\n            blob.push('Content-Disposition: form-data; name=\"' +\n                      key + '\"; filename=\"' + file.name + '\"\\r\\n');\n            blob.push('Content-Type: ' + file.type + '\\r\\n');\n            blob.push('\\r\\n');\n\n            blob.push(reader.result);\n\n            blob.push('\\r\\n');\n        }\n\n        for (let [key, value] of Object.entries(options.attrs)) {\n            if (!this.payloadFileKeys.includes(key) &&\n                value !== undefined &&\n                value !== null) {\n                blob.push('--' + boundary + '\\r\\n');\n                blob.push('Content-Disposition: form-data; name=\"' + key +\n                          '\"\\r\\n');\n                blob.push('\\r\\n');\n                blob.push(value + '\\r\\n');\n            }\n        }\n\n        blob.push('--' + boundary + '--\\r\\n\\r\\n');\n\n        Backbone.Model.prototype.save.call(this, {}, _.extend({\n            data: new Blob(blob),\n            processData: false,\n            contentType: 'multipart/form-data; boundary=' + boundary,\n        }, options));\n    },\n\n    /**\n     * Delete the object's resource on the server.\n     *\n     * An object must either be loaded or have a parent resource linking to\n     * this object's list resource URL for an object to be deleted.\n     *\n     * Args:\n     *     options (object):\n     *         Object with success and error callbacks.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     */\n    destroy(options={}, context=undefined) {\n        options = _.bindCallbacks(options, context);\n\n        this.trigger('destroying', options);\n\n        const parentObject = this.get('parentObject');\n\n        if (!this.isNew() && parentObject) {\n            /*\n             * XXX This is temporary to support older-style resource\n             *     objects. We should just use ready() once we're moved\n             *     entirely onto BaseResource.\n             */\n            parentObject.ready(_.defaults({\n                ready: () => this._destroyObject(options, context)\n            }, options));\n        } else {\n            this._destroyObject(options, context);\n        }\n    },\n\n    /**\n     * Set up the deletion of the object.\n     *\n     * This is called internally by destroy() once we've handled all the\n     * readiness and creation checks of this object and its parent.\n     *\n     * Once we've done some work to ensure the URL is valid and the object\n     * is ready, we'll finish destruction by calling _finishDestroy.\n     *\n     * Args:\n     *     options (object):\n     *         Object with success and error callbacks.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     */\n    _destroyObject(options={}, context=null) {\n        const url = _.result(this, 'url');\n\n        if (!url) {\n            if (this.isNew()) {\n                /*\n                 * If both this resource and its parent are new, it's possible\n                 * that we'll get through here without a url. In this case, all\n                 * the data is still local to the client and there's not much to\n                 * clean up; just call Model.destroy and be done with it.\n                 */\n                this._finishDestroy(options, context);\n            } else if (_.isFunction(options.error)) {\n                options.error.call(context,\n                    'The object must either be loaded from the server or ' +\n                    'have a parent object before it can be deleted');\n            }\n\n            return;\n        }\n\n        this.ready({\n            ready: () => this._finishDestroy(options, context),\n            error: _.isFunction(options.error)\n                   ? _.bind(options.error, context)\n                   : undefined\n        }, this);\n    },\n\n    /**\n     * Finish destruction of the object.\n     *\n     * This will call the parent destroy method, then reset the state\n     * of the object on success.\n     *\n     * Args:\n     *     options (object):\n     *         Object with success and error callbacks.\n     *\n     *     context (object):\n     *         Context to bind when executing callbacks.\n     */\n    _finishDestroy(options, context) {\n        const parentObject = this.get('parentObject');\n\n        Backbone.Model.prototype.destroy.call(this, _.defaults({\n            wait: true,\n            success: (...args) => {\n                /*\n                 * Reset the object so it's new again, but with the same\n                 * parentObject.\n                 */\n                this.set(_.defaults(\n                    {\n                        id: null,\n                        parentObject: parentObject\n                    },\n                    _.result(this, 'defaults')));\n\n                this.trigger('destroyed', options);\n\n                if (_.isFunction(options.success)) {\n                    options.success.apply(context, args);\n                }\n            }\n        }, _.bindCallbacks(options, context)));\n    },\n\n    /**\n     * Parse and returns the payload from an API response.\n     *\n     * This will by default only return the object's ID and list of links.\n     * Subclasses should override this to return any additional data that's\n     * needed, but they must include the results of\n     * BaseResource.protoype.parse as well.\n     *\n     * Args:\n     *     rsp (object):\n     *         The payload received from the server.\n     *\n     * Returns:\n     *     object:\n     *     Attributes to set on the model.\n     */\n    parse(rsp) {\n        console.assert(this.rspNamespace,\n                       'rspNamespace must be defined on the resource model');\n\n        if (rsp.stat !== undefined) {\n            /*\n             * This resource payload is inside an envelope from an API\n             * call. It's not model construction data or from a list\n             * resource.\n             */\n            rsp = rsp[this.rspNamespace];\n        }\n\n        return _.defaults({\n            extraData: rsp.extra_data,\n            id: rsp.id,\n            links: rsp.links,\n            loaded: true\n        }, this.parseResourceData(rsp));\n    },\n\n    /*\n     * Parse the resource data from a payload.\n     *\n     * By default, this will make use of attrToJsonMap and any\n     * jsonDeserializers to construct a resulting set of attributes.\n     *\n     * This can be overridden by subclasses.\n     *\n     * Args:\n     *     rsp (object):\n     *         The payload received from the server.\n     *\n     * Returns:\n     *     object:\n     *     Attributes to set on the model.\n     */\n    parseResourceData(rsp) {\n        const attrs = {};\n\n        for (let attrName of this.deserializedAttrs) {\n            const deserializer = this.deserializers[attrName];\n            const jsonField = this.attrToJsonMap[attrName] || attrName;\n            let value = rsp[jsonField];\n\n            if (deserializer) {\n                value = deserializer.call(this, value);\n            }\n\n            if (value !== undefined) {\n                attrs[attrName] = value;\n            }\n        }\n\n        return attrs;\n    },\n\n    /**\n     * Serialize and return object data for the purpose of saving.\n     *\n     * When saving to the server, the only data that will be sent in the\n     * API PUT/POST call will be the data returned from toJSON().\n     *\n     * This will build the list based on the serializedAttrs, serializers,\n     * and attrToJsonMap properties.\n     *\n     * Subclasses can override this to create custom serialization behavior.\n     *\n     * Returns:\n     *     object:\n     *     The serialized data.\n     */\n    toJSON() {\n        const serializerState = {\n            isNew: this.isNew(),\n            loaded: this.get('loaded')\n        };\n        const data = {};\n\n        for (let attrName of this.serializedAttrs) {\n            const serializer = this.serializers[attrName];\n            let value = this.get(attrName);\n\n            if (serializer) {\n                value = serializer.call(this, value, serializerState);\n            }\n\n            const jsonField = this.attrToJsonMap[attrName] || attrName;\n            data[jsonField] = value;\n        }\n\n        if (this.supportsExtraData) {\n            _.extend(data, this.extraData.toJSON());\n        }\n\n        return data;\n    },\n\n    /**\n     * Handle all AJAX communication for the model and its subclasses.\n     *\n     * Backbone.js will internally call the model's sync function to\n     * communicate with the server, which usually uses Backbone.sync.\n     *\n     * We wrap this to convert the data to encoded form data (instead\n     * of Backbone's default JSON payload).\n     *\n     * We also parse the error response from Review Board so we can provide\n     * a more meaningful error callback.\n     *\n     * Args:\n     *     method (string):\n     *         The HTTP method to use.\n     *\n     *     model (Backbone.Model):\n     *         The model to sync.\n     *\n     *     options (object):\n     *         Options for the operation.\n     *\n     * Option Args:\n     *     data (object):\n     *         Optional payload data to include.\n     *\n     *     form (jQuery):\n     *         Optional form to be submitted.\n     *\n     *     attrs (Array or object):\n     *         Either a list of the model attributes to sync, or a set of\n     *         key/value pairs to use instead of the model attributes.\n     */\n    sync(method, model, options={}) {\n        let data;\n        let contentType;\n\n        if (method === 'read') {\n            data = options.data || {};\n\n            const extraQueryArgs = _.result(this, 'extraQueryArgs', {});\n\n            if (!_.isEmpty(extraQueryArgs)) {\n                data = _.extend({}, extraQueryArgs, data);\n            }\n        } else {\n            if (options.form) {\n                data = null;\n            } else if (options.attrs && !_.isArray(options.attrs)) {\n                data = options.attrs;\n            } else {\n                data = model.toJSON(options);\n\n                if (options.attrs) {\n                    data = _.pick(\n                        data,\n                        options.attrs.map(attr => this.attrToJsonMap[attr]\n                                                  || attr));\n                }\n            }\n\n            contentType = 'application/x-www-form-urlencoded';\n        }\n\n        const syncOptions = _.defaults({}, options, {\n            /* Use form data instead of a JSON payload. */\n            contentType: contentType,\n            data: data,\n            processData: true\n        });\n\n        if (!options.form && this.expandedFields.length > 0) {\n            syncOptions.data.expand = this.expandedFields.join(',');\n        }\n\n        syncOptions.error = xhr => {\n            RB.storeAPIError(xhr);\n\n            const rsp = xhr.errorPayload;\n\n            if (rsp && _.has(rsp, this.rspNamespace)) {\n                /*\n                 * The response contains the current version of the object,\n                 * which we want to preserve, in case it did any partial\n                 * updating of data.\n                 */\n                this.set(this.parse(rsp));\n            }\n\n            if (_.isFunction(options.error)) {\n                options.error(xhr);\n            }\n        };\n\n        return Backbone.sync.call(this, method, model, syncOptions);\n    },\n\n    /**\n     * Perform validation on the attributes of the resource.\n     *\n     * By default, this validates the extraData field, if provided.\n     *\n     * Args:\n     *     attrs (object):\n     *         The attributes to validate.\n     *\n     * Returns:\n     *     string:\n     *     An error string or ``undefined``.\n     */\n    validate(attrs) {\n        if (this.supportsExtraData && attrs.extraData !== undefined) {\n            const strings = RB.BaseResource.strings;\n\n            if (!_.isObject(attrs.extraData)) {\n                return strings.INVALID_EXTRADATA_TYPE;\n            }\n\n            for (let [key, value] of Object.entries(attrs.extraData)) {\n                if (!_.isNull(value) &&\n                    (!_.isNumber(value) || _.isNaN(value)) &&\n                    !_.isBoolean(value) &&\n                    !_.isString(value)) {\n                    return strings.INVALID_EXTRADATA_VALUE_TYPE\n                        .replace('{key}', key);\n                }\n            }\n        }\n    }\n}, {\n    strings: {\n        UNSET_PARENT_OBJECT: 'parentObject must be set',\n        INVALID_EXTRADATA_TYPE:\n            'extraData must be an object or undefined',\n        INVALID_EXTRADATA_VALUE_TYPE:\n            'extraData.{key} must be null, a number, boolean, or string'\n    }\n});\n\n\n_.extend(RB.BaseResource.prototype, RB.ExtraDataMixin);\n"]}