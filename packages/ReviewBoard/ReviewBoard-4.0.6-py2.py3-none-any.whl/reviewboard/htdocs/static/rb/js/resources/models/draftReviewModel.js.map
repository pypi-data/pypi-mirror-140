{"version":3,"sources":["draftReviewModel.es6.js"],"names":[],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAAC,WAAH,GAAiB,EAAE,CAAC,MAAH,CAAU,MAAV,CAAiB,CAAC,CAAC,MAAF,CAAS;AACvC,EAAA,QAAQ,EAAE,CAAC,CAAC,QAAF,CAAW;AACjB,IAAA,iBAAiB,EAAE,KADF;AAEjB,IAAA,kBAAkB,EAAE;AAFH,GAAX,EAGP,EAAE,CAAC,MAAH,CAAU,SAAV,CAAoB,QAApB,EAHO,CAD6B;AAMvC,EAAA,aAAa,EAAE,CAAC,CAAC,QAAF,CAAW;AACtB,IAAA,iBAAiB,EAAE,qBADG;AAEtB,IAAA,kBAAkB,EAAE;AAFE,GAAX,EAGZ,EAAE,CAAC,MAAH,CAAU,SAAV,CAAoB,aAHR,CANwB;AAWvC,EAAA,eAAe,EAAE,CACb,mBADa,EAEb,oBAFa,EAGf,MAHe,CAGR,EAAE,CAAC,MAAH,CAAU,SAAV,CAAoB,eAHZ,CAXsB;AAgBvC,EAAA,WAAW,EAAE,CAAC,CAAC,QAAF,CAAW;AACpB,IAAA,iBAAiB,EAAE,EAAE,CAAC,eAAH,CAAmB,WADlB;AAEpB,IAAA,kBAAkB,EAAE,EAAE,CAAC,eAAH,CAAmB;AAFnB,GAAX,EAGV,EAAE,CAAC,MAAH,CAAU,SAAV,CAAoB,WAHV,CAhB0B;;AAsBvC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,OArCuC,qBAqCA;AAAA;;AAAA,QAA/B,OAA+B,uEAAvB,EAAuB;AAAA,QAAnB,OAAmB,uEAAX,SAAW;AACnC,SAAK,OAAL,CAAa,YAAb;AAEA,SAAK,KAAL,CAAW;AACP,MAAA,KAAK,EAAE,iBAAM;AACT,QAAA,KAAI,CAAC,GAAL,CAAS,QAAT,EAAmB,IAAnB;;AACA,QAAA,KAAI,CAAC,IAAL,CAAU;AACN,UAAA,KAAK,EAAE,OAAO,CAAC,KADT;AAEN,UAAA,OAAO,EAAE,mBAAM;AACX,YAAA,KAAI,CAAC,OAAL,CAAa,WAAb;;AAEA,gBAAI,CAAC,CAAC,UAAF,CAAa,OAAO,CAAC,OAArB,CAAJ,EAAmC;AAC/B,cAAA,OAAO,CAAC,OAAR,CAAgB,IAAhB,CAAqB,OAArB;AACH;AACJ,WARK;AASN,UAAA,KAAK,EAAE,eAAC,KAAD,EAAQ,GAAR,EAAgB;AACnB,YAAA,KAAK,CAAC,OAAN,CAAc,cAAd,EAA8B,GAAG,CAAC,SAAlC;;AAEA,gBAAI,CAAC,CAAC,UAAF,CAAa,OAAO,CAAC,KAArB,CAAJ,EAAiC;AAC7B,cAAA,OAAO,CAAC,KAAR,CAAc,IAAd,CAAmB,OAAnB,EAA4B,KAA5B,EAAmC,GAAnC;AACH;AACJ;AAfK,SAAV,EAgBG,KAhBH;AAiBH,OApBM;AAqBP,MAAA,KAAK,EAAE;AArBA,KAAX,EAsBG,IAtBH;AAuBH;AA/DsC,CAAT,EAgE/B,EAAE,CAAC,uBAhE4B,CAAjB,CAAjB","file":"draftReviewModel.js","sourcesContent":["/**\n * A draft review.\n *\n * Draft reviews are more complicated than most objects. A draft may already\n * exist on the server, in which case we need to be able to get its ID. A\n * special resource exists at /reviews/draft/ which will redirect to the\n * existing draft if one exists, and return 404 if not.\n */\nRB.DraftReview = RB.Review.extend(_.extend({\n    defaults: _.defaults({\n        publishAndArchive: false,\n        publishToOwnerOnly: false,\n    }, RB.Review.prototype.defaults()),\n\n    attrToJsonMap: _.defaults({\n        publishAndArchive: 'publish_and_archive',\n        publishToOwnerOnly: 'publish_to_owner_only',\n    }, RB.Review.prototype.attrToJsonMap),\n\n    serializedAttrs: [\n        'publishAndArchive',\n        'publishToOwnerOnly',\n    ].concat(RB.Review.prototype.serializedAttrs),\n\n    serializers: _.defaults({\n        publishAndArchive: RB.JSONSerializers.onlyIfValue,\n        publishToOwnerOnly: RB.JSONSerializers.onlyIfValue,\n    }, RB.Review.prototype.serializers),\n\n\n    /**\n     * Publish the review.\n     *\n     * Before publish, the \"publishing\" event will be triggered.\n     *\n     * After the publish has succeeded, the \"published\" event will be\n     * triggered.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the operation, including callbacks.\n     *\n     *     context (object):\n     *         Context to bind when calling callbacks.\n     */\n    publish(options={}, context=undefined) {\n        this.trigger('publishing');\n\n        this.ready({\n            ready: () => {\n                this.set('public', true);\n                this.save({\n                    attrs: options.attrs,\n                    success: () => {\n                        this.trigger('published');\n\n                        if (_.isFunction(options.success)) {\n                            options.success.call(context);\n                        }\n                    },\n                    error: (model, xhr) => {\n                        model.trigger('publishError', xhr.errorText);\n\n                        if (_.isFunction(options.error)) {\n                            options.error.call(context, model, xhr);\n                        }\n                    }\n                }, this);\n            },\n            error: error\n        }, this);\n    }\n}, RB.DraftResourceModelMixin));\n"]}