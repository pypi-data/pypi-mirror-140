{"version":3,"sources":["draftReviewBannerViewTests.es6.js"],"names":[],"mappings":"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","file":"draftReviewBannerViewTests.js","sourcesContent":["suite('rb/views/DraftReviewBannerView', function() {\n    const template = dedent`\n        <div id=\"review-banner\" hidden class=\"hidden\">\n         <div class=\"banner\">\n          <h1>You have a pending review.</h1>\n          <input id=\"review-banner-edit\" type=\"button\"\n                 value=\"Edit Review\" />\n          <input id=\"review-banner-publish-container\" type=\"button\"\n                 value=\"Publish\" />\n          <input id=\"review-banner-discard\" type=\"button\"\n                 value=\"Discard\" />\n         </div>\n        </div>'\n    `;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.DraftReview();\n        view = new RB.DraftReviewBannerView({\n            el: $(template).appendTo($testsScratch),\n            model: model,\n        });\n\n        view.render();\n    });\n\n    afterEach(function() {\n        view.remove();\n    });\n\n    describe('Button states', function() {\n        let $buttons;\n\n        beforeEach(function() {\n            $buttons = view.$('input');\n        });\n\n        describe('Enabled', function() {\n            it('Default', function() {\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When saved', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('saved');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When destroyed', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('destroyed');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n        });\n\n        describe('Disabled', function() {\n            it('When saving', function() {\n                model.trigger('saving');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n\n            it('When destroying', function() {\n                model.trigger('destroying');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n        });\n    });\n\n    describe('Button events', function() {\n        it('Edit Review', function() {\n            spyOn(RB.ReviewDialogView, 'create');\n\n            view.$('#review-banner-edit').click();\n\n            expect(RB.ReviewDialogView.create).toHaveBeenCalled();\n            expect(RB.ReviewDialogView.create.calls.argsFor(0)[0].review)\n                .toBe(model);\n        });\n\n        it('Publish', function() {\n            spyOn(model, 'publish');\n\n            view.$('#review-banner-publish').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish to Submitter Only', function() {\n            spyOn(model, 'publish');\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-submitter-only').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish and Archive', function() {\n            spyOn(model, 'publish');\n            spyOn(view, '_onPublishClicked').and.callThrough();\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-and-archive').click();\n\n            expect(model.publish).toHaveBeenCalled();\n            expect(view._onPublishClicked).toHaveBeenCalledWith({\n                publishAndArchive: true\n            });\n        });\n\n        it('Discard', function() {\n            let $buttons = $();\n\n            spyOn(model, 'destroy');\n            spyOn($.fn, 'modalBox').and.callFake(options => {\n                options.buttons.forEach($btn => {\n                    $buttons = $buttons.add($btn);\n                });\n\n                /* Simulate the modalBox API for what we need. */\n                return {\n                    modalBox: cmd => {\n                        expect(cmd).toBe('buttons');\n                        return $buttons;\n                    }\n                };\n            });\n\n            view.$('#review-banner-discard').click();\n            expect($.fn.modalBox).toHaveBeenCalled();\n\n            $buttons.filter('input[value=\"Discard\"]').click();\n            expect(model.destroy).toHaveBeenCalled();\n        });\n    });\n\n    describe('Methods', function() {\n        it('show', function() {\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n\n            view.show();\n            expect(view.$el.hasClass('hidden')).toBe(false);\n            expect(view.$el.prop('hidden')).toBe(false);\n        });\n\n        it('hide', function() {\n            view.$el\n                .addClass('hidden')\n                .prop('hidden', true);\n\n            view.hide();\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n        });\n    });\n});\n"]}