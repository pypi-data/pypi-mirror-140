{"version":3,"sources":["reviewRequestPageViewTests.es6.js"],"names":[],"mappings":";;AAAA,KAAK,CAAC,kDAAD,EAAqD,YAAW;AACjE,MAAM,QAAQ,6jCAAd;AAkCA,MAAI,IAAJ;AACA,MAAI,QAAJ;AACA,MAAI,MAAJ;AACA,MAAI,MAAJ;AAEA,EAAA,UAAU,CAAC,YAAW;AAClB,QAAM,GAAG,GAAG,CAAC,CAAC,QAAD,CAAD,CACP,IADO,CACF,QADE,EAEP,QAFO,CAEE,aAFF,CAAZ;AAIA,IAAA,EAAE,CAAC,WAAH,CAAe,QAAf,GAA0B,IAA1B;AAEA,IAAA,IAAI,GAAG,IAAI,EAAE,CAAC,iBAAH,CAAqB,iBAAzB,CAA2C;AAC9C,MAAA,eAAe,EAAE,KAD6B;AAE9C,MAAA,iBAAiB,EAAE,EAF2B;AAG9C,MAAA,UAAU,EAAE;AACR,QAAA,eAAe,EAAE,EADT;AAER,QAAA,aAAa,EAAE,IAFP;AAGR,QAAA,aAAa,EAAE;AAHP;AAHkC,KAA3C,EAQJ;AACC,MAAA,KAAK,EAAE;AADR,KARI,CAAP;AAYA,IAAA,QAAQ,GAAG,IAAI,EAAE,CAAC,iBAAH,CAAqB,qBAAzB,CAA+C;AACtD,MAAA,EAAE,EAAE,GADkD;AAEtD,MAAA,KAAK,EAAE;AAF+C,KAA/C,CAAX,CAnBkB,CAwBlB;;AACA,IAAA,KAAK,CAAC,EAAE,CAAC,iBAAH,CAAqB,qBAArB,CAA2C,SAA5C,EACC,QADD,CAAL;AAGA,QAAM,aAAa,GAAG,IAAI,CAAC,GAAL,CAAS,eAAT,CAAtB;AAEA,IAAA,QAAQ,CAAC,YAAT,CAAsB,IAAI,EAAE,CAAC,iBAAH,CAAqB,eAAzB,CAAyC;AAC3D,MAAA,KAAK,EAAE,IAAI,EAAE,CAAC,iBAAH,CAAqB,WAAzB,CAAqC;AACxC,QAAA,MAAM,EAAE,aAAa,CAAC,YAAd,CAA2B,GAA3B,EAAgC;AACpC,UAAA,MAAM,EAAE,IAD4B;AAEpC,UAAA,MAAM,EAAE,IAF4B;AAGpC,UAAA,OAAO,EAAE,UAH2B;AAIpC,UAAA,UAAU,EAAE;AAJwB,SAAhC,CADgC;AAOxC,QAAA,mBAAmB,EAAE,QAAQ,CAAC;AAPU,OAArC,CADoD;AAU3D,MAAA,EAAE,EAAE,GAAG,CAAC,IAAJ,CAAS,YAAT;AAVuD,KAAzC,CAAtB;AAaA,IAAA,QAAQ,CAAC,YAAT,CAAsB,IAAI,EAAE,CAAC,iBAAH,CAAqB,eAAzB,CAAyC;AAC3D,MAAA,KAAK,EAAE,IAAI,EAAE,CAAC,iBAAH,CAAqB,WAAzB,CAAqC;AACxC,QAAA,MAAM,EAAE,aAAa,CAAC,YAAd,CAA2B,GAA3B,EAAgC;AACpC,UAAA,MAAM,EAAE,KAD4B;AAEpC,UAAA,MAAM,EAAE,IAF4B;AAGpC,UAAA,OAAO,EAAE,UAH2B;AAIpC,UAAA,UAAU,EAAE;AAJwB,SAAhC,CADgC;AAOxC,QAAA,mBAAmB,EAAE,QAAQ,CAAC;AAPU,OAArC,CADoD;AAU3D,MAAA,EAAE,EAAE,GAAG,CAAC,IAAJ,CAAS,YAAT;AAVuD,KAAzC,CAAtB;AAaA,IAAA,QAAQ,CAAC,MAAT;AAEA,IAAA,MAAM,CAAC,QAAQ,CAAC,WAAT,CAAqB,MAAtB,CAAN,CAAoC,IAApC,CAAyC,CAAzC;AACA,IAAA,MAAM,GAAG,QAAQ,CAAC,WAAT,CAAqB,CAArB,CAAT;AACA,IAAA,MAAM,GAAG,QAAQ,CAAC,WAAT,CAAqB,CAArB,CAAT;AACH,GA7DS,CAAV;AA+DA,EAAA,SAAS,CAAC,YAAW;AACjB,IAAA,EAAE,CAAC,WAAH,CAAe,QAAf,GAA0B,IAA1B;AACH,GAFQ,CAAT;AAIA,EAAA,QAAQ,CAAC,SAAD,EAAY,YAAW;AAC3B,IAAA,EAAE,CAAC,cAAD,EAAiB,YAAW;AAC1B,UAAM,IAAI,GAAG,MAAM,CAAC,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;AACA,UAAM,IAAI,GAAG,MAAM,CAAC,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;AAEA,MAAA,MAAM,CAAC,IAAI,CAAC,QAAL,CAAc,WAAd,CAAD,CAAN,CAAmC,IAAnC,CAAwC,KAAxC;AACA,MAAA,MAAM,CAAC,IAAI,CAAC,QAAL,CAAc,WAAd,CAAD,CAAN,CAAmC,IAAnC,CAAwC,KAAxC;AAEA,MAAA,QAAQ,CAAC,CAAT,CAAW,eAAX,EAA4B,KAA5B;AAEA,MAAA,MAAM,CAAC,IAAI,CAAC,QAAL,CAAc,WAAd,CAAD,CAAN,CAAmC,IAAnC,CAAwC,IAAxC;AACA,MAAA,MAAM,CAAC,IAAI,CAAC,QAAL,CAAc,WAAd,CAAD,CAAN,CAAmC,IAAnC,CAAwC,IAAxC;AACH,KAXC,CAAF;AAaA,IAAA,EAAE,CAAC,YAAD,EAAe,YAAW;AACxB,UAAM,IAAI,GAAG,MAAM,CAAC,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;AACA,UAAM,IAAI,GAAG,MAAM,CAAC,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;AAEA,MAAA,IAAI,CAAC,QAAL,CAAc,WAAd;AACA,MAAA,IAAI,CAAC,QAAL,CAAc,WAAd;AAEA,MAAA,QAAQ,CAAC,CAAT,CAAW,aAAX,EAA0B,KAA1B;AAEA,MAAA,MAAM,CAAC,IAAI,CAAC,QAAL,CAAc,WAAd,CAAD,CAAN,CAAmC,IAAnC,CAAwC,KAAxC;AACA,MAAA,MAAM,CAAC,IAAI,CAAC,QAAL,CAAc,WAAd,CAAD,CAAN,CAAmC,IAAnC,CAAwC,KAAxC;AACH,KAXC,CAAF;AAYH,GA1BO,CAAR;AA4BA,EAAA,QAAQ,CAAC,SAAD,EAAY,YAAW;AAC3B,IAAA,QAAQ,CAAC,mBAAD,EAAsB,YAAW;AACrC,MAAA,UAAU,CAAC,YAAW;AAClB,QAAA,KAAK,CAAC,EAAE,CAAC,iBAAH,CAAqB,qBAArB,CAA2C,SAA5C,EACC,mBADD,CAAL;AAEA,QAAA,KAAK,CAAC,MAAD,EAAS,0BAAT,CAAL,CAA0C,GAA1C,CAA8C,WAA9C;AACA,QAAA,KAAK,CAAC,MAAD,EAAS,0BAAT,CAAL,CAA0C,GAA1C,CAA8C,WAA9C;AACH,OALS,CAAV;AAOA,MAAA,EAAE,CAAC,eAAD,EAAkB,YAAW;AAC3B,QAAA,QAAQ,CAAC,iBAAT,CAA2B,UAA3B;AAEA,QAAA,MAAM,CAAC,MAAM,CAAC,wBAAR,CAAN,CAAwC,gBAAxC;AACA,QAAA,MAAM,CAAC,EAAE,CAAC,iBAAH,CAAqB,qBAArB,CACC,SADD,CACW,iBADZ,CAAN,CACqC,gBADrC;AAGA;;AACA,QAAA,MAAM,CAAC,MAAM,CAAC,wBAAR,CAAN,CAAwC,GAAxC,CAA4C,gBAA5C;AACH,OATC,CAAF;AAWA,MAAA,EAAE,CAAC,kBAAD,EAAqB,YAAW;AAC9B,QAAA,QAAQ,CAAC,iBAAT,CAA2B,aAA3B;AAEA,QAAA,MAAM,CAAC,MAAM,CAAC,wBAAR,CAAN,CAAwC,gBAAxC;AACA,QAAA,MAAM,CAAC,EAAE,CAAC,iBAAH,CAAqB,qBAArB,CACC,SADD,CACW,iBADZ,CAAN,CACqC,gBADrC;AAGA;;AACA,QAAA,MAAM,CAAC,MAAM,CAAC,wBAAR,CAAN,CAAwC,GAAxC,CAA4C,gBAA5C;AACH,OATC,CAAF;AAWA,MAAA,EAAE,CAAC,eAAD,EAAkB,YAAW;AAC3B,QAAA,QAAQ,CAAC,iBAAT,CAA2B,eAA3B,EAA4C,GAA5C;AAEA,QAAA,MAAM,CAAC,MAAM,CAAC,wBAAR,CAAN,CAAwC,gBAAxC;AACA,QAAA,MAAM,CAAC,EAAE,CAAC,iBAAH,CAAqB,qBAArB,CACC,SADD,CACW,iBADZ,CAAN,CACqC,gBADrC;AAGA;;AACA,QAAA,MAAM,CAAC,MAAM,CAAC,wBAAR,CAAN,CAAwC,GAAxC,CAA4C,gBAA5C;AACH,OATC,CAAF;AAUH,KAxCO,CAAR;AAyCH,GA1CO,CAAR;AA2CH,CAlLI,CAAL","file":"reviewRequestPageViewTests.js","sourcesContent":["suite('rb/reviewRequestPage/views/ReviewRequestPageView', function() {\n    const template = dedent`\n        <div id=\"review-banner\"></div>\n        <a id=\"collapse-all\"></a>\n        <a id=\"expand-all\"></a>\n        <div>\n         <div class=\"review review-request-page-entry\" id=\"review123\">\n          <div class=\"review-request-page-entry-contents\">\n           <div class=\"body\">\n            <pre class=\"body_top\">Body Top</pre>\n            <div class=\"comment-section\" data-context-type=\"body_top\">\n            </div>\n            <div class=\"comment-section\" data-context-id=\"123\"\n                 data-context-type=\"diff_comments\">\n            </div>\n            <pre class=\"body_bottom\">Body Bottom</pre>\n            <div class=\"comment-section\" data-context-type=\"body_bottom\">\n            </div>\n           </div>\n         </div>\n         <div class=\"review review-request-page-entry\" id=\"review124\">\n          <div class=\"review-request-page-entry-contents\">\n           <div class=\"body\">\n            <pre class=\"body_top\">Body Top</pre>\n            <div class=\"comment-section\" data-context-type=\"body_top\">\n            </div>\n            <pre class=\"body_bottom\">Body Bottom</pre>\n            <div class=\"comment-section\" data-context-type=\"body_bottom\">\n            </div>\n           </div>\n          </div>\n         </div>\n        </div>\n    `;\n\n    let page;\n    let pageView;\n    let entry1;\n    let entry2;\n\n    beforeEach(function() {\n        const $el = $('<div/>')\n            .html(template)\n            .appendTo($testsScratch);\n\n        RB.DnDUploader.instance = null;\n\n        page = new RB.ReviewRequestPage.ReviewRequestPage({\n            checkForUpdates: false,\n            reviewRequestData: {},\n            editorData: {\n                fileAttachments: [],\n                mutableByUser: true,\n                showSendEmail: false,\n            },\n        }, {\n            parse: true,\n        });\n\n        pageView = new RB.ReviewRequestPage.ReviewRequestPageView({\n            el: $el,\n            model: page,\n        });\n\n        // Stub this out.\n        spyOn(RB.ReviewRequestPage.IssueSummaryTableView.prototype,\n              'render');\n\n        const reviewRequest = page.get('reviewRequest');\n\n        pageView.addEntryView(new RB.ReviewRequestPage.ReviewEntryView({\n            model: new RB.ReviewRequestPage.ReviewEntry({\n                review: reviewRequest.createReview(123, {\n                    shipIt: true,\n                    public: true,\n                    bodyTop: 'Body Top',\n                    bodyBottom: 'Body Bottom',\n                }),\n                reviewRequestEditor: pageView.reviewRequestEditor,\n            }),\n            el: $el.find('#review123'),\n        }));\n\n        pageView.addEntryView(new RB.ReviewRequestPage.ReviewEntryView({\n            model: new RB.ReviewRequestPage.ReviewEntry({\n                review: reviewRequest.createReview(124, {\n                    shipIt: false,\n                    public: true,\n                    bodyTop: 'Body Top',\n                    bodyBottom: 'Body Bottom',\n                }),\n                reviewRequestEditor: pageView.reviewRequestEditor,\n            }),\n            el: $el.find('#review124'),\n        }));\n\n        pageView.render();\n\n        expect(pageView._entryViews.length).toBe(2);\n        entry1 = pageView._entryViews[0];\n        entry2 = pageView._entryViews[1];\n    });\n\n    afterEach(function() {\n        RB.DnDUploader.instance = null;\n    });\n\n    describe('Actions', function() {\n        it('Collapse all', function() {\n            const $el1 = entry1.$el.find('.review-request-page-entry-contents');\n            const $el2 = entry2.$el.find('.review-request-page-entry-contents');\n\n            expect($el1.hasClass('collapsed')).toBe(false);\n            expect($el2.hasClass('collapsed')).toBe(false);\n\n            pageView.$('#collapse-all').click();\n\n            expect($el1.hasClass('collapsed')).toBe(true);\n            expect($el2.hasClass('collapsed')).toBe(true);\n        });\n\n        it('Expand all', function() {\n            const $el1 = entry1.$el.find('.review-request-page-entry-contents');\n            const $el2 = entry2.$el.find('.review-request-page-entry-contents');\n\n            $el1.addClass('collapsed');\n            $el2.addClass('collapsed');\n\n            pageView.$('#expand-all').click();\n\n            expect($el1.hasClass('collapsed')).toBe(false);\n            expect($el2.hasClass('collapsed')).toBe(false);\n        });\n    });\n\n    describe('Methods', function() {\n        describe('openCommentEditor', function() {\n            beforeEach(function() {\n                spyOn(RB.ReviewRequestPage.ReviewReplyEditorView.prototype,\n                      'openCommentEditor');\n                spyOn(entry1, 'getReviewReplyEditorView').and.callThrough();\n                spyOn(entry2, 'getReviewReplyEditorView').and.callThrough();\n            });\n\n            it('With body_top', function() {\n                pageView.openCommentEditor('body_top');\n\n                expect(entry1.getReviewReplyEditorView).toHaveBeenCalled();\n                expect(RB.ReviewRequestPage.ReviewReplyEditorView\n                       .prototype.openCommentEditor).toHaveBeenCalled();\n\n                /* We should have matched the first one. */\n                expect(entry2.getReviewReplyEditorView).not.toHaveBeenCalled();\n            });\n\n            it('With body_bottom', function() {\n                pageView.openCommentEditor('body_bottom');\n\n                expect(entry1.getReviewReplyEditorView).toHaveBeenCalled();\n                expect(RB.ReviewRequestPage.ReviewReplyEditorView\n                       .prototype.openCommentEditor).toHaveBeenCalled();\n\n                /* We should have matched the first one. */\n                expect(entry2.getReviewReplyEditorView).not.toHaveBeenCalled();\n            });\n\n            it('With comments', function() {\n                pageView.openCommentEditor('diff_comments', 123);\n\n                expect(entry1.getReviewReplyEditorView).toHaveBeenCalled();\n                expect(RB.ReviewRequestPage.ReviewReplyEditorView\n                       .prototype.openCommentEditor).toHaveBeenCalled();\n\n                /* We should have matched the first one. */\n                expect(entry2.getReviewReplyEditorView).not.toHaveBeenCalled();\n            });\n        });\n    });\n});\n"]}