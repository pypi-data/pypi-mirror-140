{"version":3,"sources":["repositoryCommitsCollection.es6.js"],"names":[],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAAC,iBAAH,GAAuB,EAAE,CAAC,cAAH,CAAkB,MAAlB,CAAyB;AAC5C,EAAA,KAAK,EAAE,EAAE,CAAC,gBADkC;;AAG5C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,UAvB4C,sBAuBjC,MAvBiC,EAuBzB,OAvByB,EAuBhB;AACxB,IAAA,QAAQ,CAAC,UAAT,CAAoB,SAApB,CAA8B,UAA9B,CAAyC,IAAzC,CAA8C,IAA9C,EAAoD,MAApD,EAA4D,OAA5D;AACA,SAAK,OAAL,GAAe,OAAf;AACA,SAAK,IAAL,GAAY,KAAZ;AACA,SAAK,QAAL,GAAgB,KAAhB;AACA,SAAK,UAAL,GAAkB,IAAlB;AACH,GA7B2C;;AA+B5C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,KA1C4C,iBA0CtC,QA1CsC,EA0C5B;AACZ,QAAM,OAAO,GAAG,QAAQ,CAAC,OAAzB;AAEA,SAAK,UAAL,GAAkB,OAAO,CAAC,OAAO,CAAC,MAAR,GAAiB,CAAlB,CAAP,CAA4B,MAA9C;AACA,SAAK,QAAL,GAAgB,CAAC,KAAK,UAAtB;AAEA,WAAO,QAAQ,CAAC,OAAhB;AACH,GAjD2C;;AAmD5C;AACJ;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,GA1D4C,iBA0DtC;AACF,QAAM,MAAM,GAAG,EAAf;;AAEA,QAAI,KAAK,OAAL,CAAa,KAAb,KAAuB,SAA3B,EAAsC;AAClC,MAAA,MAAM,CAAC,KAAP,GAAe,KAAK,OAAL,CAAa,KAA5B;AACH;;AAED,QAAI,KAAK,OAAL,CAAa,MAAb,KAAwB,SAA5B,EAAuC;AACnC,MAAA,MAAM,CAAC,MAAP,GAAgB,KAAK,OAAL,CAAa,MAA7B;AACH;;AAED,WAAO,KAAK,OAAL,CAAa,OAAb,GAAuB,GAAvB,GAA6B,CAAC,CAAC,KAAF,CAAQ,MAAR,CAApC;AACH,GAtE2C;;AAwE5C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,YAtF4C,0BAsF7B;AACX,WAAO,CAAC,KAAK,IAAN,IAAc,CAAC,KAAK,QAApB,IAAgC,KAAK,MAAL,CAAY,MAAZ,GAAqB,CAA5D;AACH,GAxF2C;;AA0F5C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,SAtH4C,uBAsHtB;AAAA;;AAAA,QAAZ,OAAY,uEAAJ,EAAI;;AAClB,QAAI,KAAK,YAAL,EAAJ,EAAyB;AACrB,WAAK,OAAL,CAAa,KAAb,GAAqB,KAAK,UAA1B;AAEA,WAAK,KAAL,CAAW;AACP,QAAA,MAAM,EAAE,KADD;AAEP,QAAA,OAAO,EAAE,mBAAM;AACX,UAAA,KAAI,CAAC,IAAL,GAAY,KAAZ;;AAEA,cAAI,CAAC,CAAC,UAAF,CAAa,OAAO,CAAC,OAArB,CAAJ,EAAmC;AAC/B,YAAA,OAAO,CAAC,OAAR;AACH;AACJ,SARM;AASP,QAAA,KAAK,EAAE,OAAO,CAAC;AATR,OAAX;AAWH;AACJ;AAtI2C,CAAzB,CAAvB","file":"repositoryCommitsCollection.js","sourcesContent":["/**\n * A collection of commits in a repository.\n *\n * This is expected to be used in an ephemeral manner to get a list of commits\n * from a given start point (usually corresponding to some branch in the\n * repository).\n */\nRB.RepositoryCommits = RB.BaseCollection.extend({\n    model: RB.RepositoryCommit,\n\n    /**\n     * Initialize the collection.\n     *\n     * Args:\n     *     models (Array of object):\n     *         Initial models for the collection.\n     *\n     *     options (Object):\n     *         Options for the collection.\n     *\n     * Option Args:\n     *     start (string):\n     *         The start commit for fetching commit logs.\n     *\n     *     branch (string):\n     *         The branch name for fetching commit logs.\n     *\n     *     urlBase (string):\n     *         The base URL for the API request.\n     */\n    initialize(models, options) {\n        Backbone.Collection.prototype.initialize.call(this, models, options);\n        this.options = options;\n        this.busy = false;\n        this.complete = false;\n        this._nextStart = null;\n    },\n\n    /**\n     * Parse the response.\n     *\n     * Args:\n     *     response (object):\n     *         Response, parsed from the JSON returned by the server.\n     *\n     * Returns:\n     *     Array of object:\n     *     An array of commits.\n     */\n    parse(response) {\n        const commits = response.commits;\n\n        this._nextStart = commits[commits.length - 1].parent;\n        this.complete = !this._nextStart;\n\n        return response.commits;\n    },\n\n    /**\n     * Get the URL to fetch for the next page of results.\n     *\n     * Returns:\n     *     string:\n     *     The URL to fetch.\n     */\n    url() {\n        const params = {};\n\n        if (this.options.start !== undefined) {\n            params.start = this.options.start;\n        }\n\n        if (this.options.branch !== undefined) {\n            params.branch = this.options.branch;\n        }\n\n        return this.options.urlBase + '?' + $.param(params);\n    },\n\n    /**\n     * Return whether another page of commits can be fetched.\n     *\n     * A page can only be fetched if there's at least 1 commit already\n     * fetched, the last commit in the repository has not been fetched, and\n     * another fetch operation isn't in progress.\n     *\n     * Version Added:\n     *     4.0.3\n     *\n     * Returns:\n     *     boolean:\n     *     ``true`` if another page can be fetched. ``false`` if one cannot.\n     */\n    canFetchNext() {\n        return !this.busy && !this.complete && this.models.length > 0;\n    },\n\n    /**\n     * Fetch the next page of results.\n     *\n     * This can be called multiple times. If this is called when a fetch is\n     * already in progress, it's a no-op. Otherwise, if there are more commits\n     * to load, it will fetch them and add them to the bottom of the\n     * collection.\n     *\n     * It's up to the caller to check :js:func:`canFetchNext()` before calling\n     * this if they want callbacks to fire.\n     *\n     * Version Changed:\n     *     4.0.3:\n     *     Added the ``options`` argument with ``error`` and ``success``\n     *     callbacks.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options for fetching the next page of results.\n     *\n     * Option Args:\n     *     error (function):\n     *         A function to call if fetching a page fails. This must take\n     *         ``collection, xhr`` arguments.\n     *\n     *     success (function):\n     *         A function to call if fetching a page succeeds.\n     */\n    fetchNext(options={}) {\n        if (this.canFetchNext()) {\n            this.options.start = this._nextStart;\n\n            this.fetch({\n                remove: false,\n                success: () => {\n                    this.busy = false;\n\n                    if (_.isFunction(options.success)) {\n                        options.success();\n                    }\n                },\n                error: options.error,\n            });\n        }\n    }\n});\n"]}